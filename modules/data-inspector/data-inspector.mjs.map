{
  "version": 3,
  "sources": ["../core/common.mjs", "../core/compat.mjs", "../core/editor.mjs", "../core/data-structure.mjs", "../core/dialog.mjs", "../data-inspector.mjs"],
  "sourcesContent": ["export const CFG = {\n\tmodule: 'data-inspector',\n\tSETTINGS: {\n\t\tallowEditing: 'allowEditing',\n\t\tallowEditingUnsupported: 'allowEditingUnsupported',\n\t\tallowUsers: 'allowUsers',\n\t\tfunctions: 'functions',\n\t\tresults: 'results',\n\t\tmode: 'mode',\n\t},\n\tCOLORS: {\n\t\tmain: 'color:deepskyblue',\n\t\tnumber: 'color:mediumpurple',\n\t\tlabel: 'color:mediumseagreen',\n\t\tid: 'color:darkseagreen',\n\t\tunset: 'color:unset',\n\t},\n};\n\nexport async function copyToClipboard(text) {\n\tif (window.isSecureContext) // Required\n\t\treturn navigator.clipboard.writeText(text);\n\telse\n\t\tui.notification.warn('Copying to clipboard requires secure contet (HTTPS) in modern browsers.');\n}\n\nexport const DATA_TYPES = {\n\tundefined: -1,\n\tnull: 0,\n\tobject: 110,\n\tnumber: 410,\n\tboolean: 420,\n\tstring: 430,\n\tarray: 120,\n\tmap: 510,\n\tfunction: 910,\n\tgetter: 980,\n\tcustom: 1000,\n\tdata: 2010,\n\tdocument: 2020,\n}\n\nexport const DATA_TYPE_INVERTED = invertObject(DATA_TYPES);\n\n/**\n * Better type name getter.\n * @returns {String}\n */\nexport function getTypeName(value) {\n\tif (value === undefined) return 'undefined';\n\tif (value === null) return 'null';\n\tconst type = typeof value;\n\tif (['string', 'number', 'function', 'boolean'].includes(type)) return type;\n\tif (Array.isArray(value)) return 'array';\n\t// Gets class name more reliably than just value.contructor.name\n\tconst n = value.__proto__.constructor.name\n\tif (n === 'Object') return 'object';\n\tif (n === 'Map') return 'map';\n\treturn '_' + n; // underscore to ensure they don't conflict with the other names under any circumstances\n}\n\nexport function getTypeId(value) {\n\tif (value === undefined) return DATA_TYPES.undefined;\n\tif (value === null) return DATA_TYPES.null;\n\tconst type = typeof value;\n\tswitch (type) {\n\t\tcase 'string':\n\t\t\treturn DATA_TYPES.string;\n\t\tcase 'number':\n\t\t\treturn DATA_TYPES.number;\n\t\tcase 'function':\n\t\t\treturn DATA_TYPES.function;\n\t\tcase 'boolean':\n\t\t\treturn DATA_TYPES.boolean;\n\t}\n\tif (Array.isArray(value)) return DATA_TYPES.array;\n\tif (value instanceof foundry.abstract.DocumentData) return DATA_TYPES.data;\n\tif (value instanceof foundry.abstract.Document) return DATA_TYPES.document;\n\t// Gets class name more reliably than just value.contructor.name\n\tconst n = value.__proto__.constructor.name;\n\tif (n === 'Object') return DATA_TYPES.object;\n\tif (n === 'Map') return DATA_TYPES.map;\n\treturn DATA_TYPES.custom;\n}\n\nHooks.once('init', function registerSettings() {\n\tgame.settings.register(CFG.module, CFG.SETTINGS.mode, {\n\t\tname: 'Koboldworks.DataInspector.Settings.DefaultMode',\n\t\thint: 'Koboldworks.DataInspector.Settings.DefaultModeHint',\n\t\tscope: 'client',\n\t\tconfig: true,\n\t\ttype: String,\n\t\tdefault: 'rolldata',\n\t\tchoices: {\n\t\t\trolldata: 'Koboldworks.DataInspector.Data.Roll',\n\t\t\tsource: 'Koboldworks.DataInspector.Data.Source',\n\t\t\tderived: 'Koboldworks.DataInspector.Data.Derived',\n\t\t}\n\t});\n\n\tgame.settings.register(CFG.module, CFG.SETTINGS.results, {\n\t\tname: 'Koboldworks.DataInspector.Settings.ResultQuality',\n\t\thint: 'Koboldworks.DataInspector.Settings.ResultQualityHint',\n\t\tscope: 'client',\n\t\tconfig: true,\n\t\ttype: Number,\n\t\tdefault: 0.7,\n\t\trange: { min: 0.0, max: 1.0, step: 0.01 }\n\t});\n\n\tgame.settings.register(CFG.module, CFG.SETTINGS.functions, {\n\t\tname: 'Koboldworks.DataInspector.Settings.IncludeFunctions',\n\t\thint: 'Koboldworks.DataInspector.Settings.IncludeFunctionsHint',\n\t\tscope: 'client',\n\t\tconfig: true,\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t});\n\n\tgame.settings.register(CFG.module, CFG.SETTINGS.allowEditing, {\n\t\tname: 'Koboldworks.DataInspector.Settings.AllowEditing',\n\t\thint: 'Koboldworks.DataInspector.Settings.AllowEditingHint',\n\t\tconfig: true,\n\t\tscope: 'world',\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t});\n\n\tgame.settings.register(CFG.module, CFG.SETTINGS.allowEditingUnsupported, {\n\t\tname: 'Koboldworks.DataInspector.Settings.AllowEditingUnsupported',\n\t\thint: 'Koboldworks.DataInspector.Settings.AllowEditingUnsupportedHint',\n\t\tconfig: true,\n\t\tscope: 'world',\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t});\n\n\tgame.settings.register(CFG.module, CFG.SETTINGS.allowUsers, {\n\t\tname: 'Koboldworks.DataInspector.Settings.AllowUsers',\n\t\thint: 'Koboldworks.DataInspector.Settings.AllowUsersHint',\n\t\tconfig: true,\n\t\tscope: 'world',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t});\n});\n", "export const getDocData = (doc) => game.release.generation >= 10 ? doc : doc?.data;\nexport const isEmpty = (obj) => game.release.generation >= 10 ? foundry.utils.isEmpty(obj) : foundry.utils.isObjectEmpty(obj);\nexport const systemPrefix = () => game.release.generation >= 10 ? 'system' : 'data';\nexport const getDocSystemData = (doc) => game.release.generation >= 10 ? doc?.system : doc?.data.data;\n", "import { CFG, getTypeName, getTypeId, DATA_TYPES, DATA_TYPE_INVERTED } from './common.mjs';\n\nexport class ValueEditor extends FormApplication {\n\t_path;\n\t_type;\n\t/** @type {Actor|Item} */\n\tdocument;\n\n\t/** @type {DataInspectorDialog} */\n\tparentApp;\n\n\tstatic get supportedTypes() { return [DATA_TYPES.number, DATA_TYPES.string, DATA_TYPES.boolean, DATA_TYPES.null, DATA_TYPES.undefined]; }\n\n\tconstructor(document, path, type, { isToken = false, app } = {}) {\n\t\tconst title = ['Data Inspector'];\n\t\ttitle.push(document.name);\n\t\ttitle.push(path);\n\t\tconst options = {};\n\t\toptions.title = title.join(': ');\n\t\toptions.id = 'lil-data-inspector-' + document.uuid + '-' + path;\n\n\t\tsuper(undefined, options);\n\n\t\tthis.parentApp = app;\n\t\tthis.isToken = isToken;\n\t\tthis._path = path;\n\t\t// this.object = { value: undefined };\n\t\tthis.document = document;\n\t\tconst value = getProperty(document.toObject(), path);\n\t\tthis.originalTypeId = type ?? getTypeId(value);\n\t\tthis.originalTypeName = DATA_TYPE_INVERTED[this.originalTypeId];\n\t\tthis._type = this.originalTypeName;\n\t\t// Register for updates\n\t\t// document.apps[this.appId] = this;\n\t}\n\n\tget template() {\n\t\treturn `modules/${CFG.module}/template/editor.hbs`;\n\t}\n\n\tstatic get defaultOptions() {\n\t\tconst _default = super.defaultOptions;\n\t\treturn mergeObject(_default, {\n\t\t\t..._default,\n\t\t\ttitle: 'Data Inspector \u2013 Editor',\n\t\t\tclasses: [..._default.classes, 'koboldworks', 'data-inspector-editor'],\n\t\t\tsubmitOnChange: false,\n\t\t\tsubmitOnClose: false,\n\t\t\tcloseOnSubmit: false,\n\t\t\tresizable: true,\n\t\t\twidth: 520,\n\t\t\theight: 360,\n\t\t});\n\t}\n\n\tgetData() {\n\t\t// console.log('Editor.getData');\n\t\tconst data = super.getData();\n\n\t\tconst doc = this.document,\n\t\t\tvalue = getProperty(doc.toObject(), this._path),\n\t\t\ttypeId = this._typeId = getTypeId(value),\n\t\t\ttypeName = this._type ?? getTypeName(value),\n\t\t\toriginalTypeName = this.originalTypeName;\n\n\t\tdata.document = doc;\n\t\tdata.path = this._path;\n\t\tdata.value = value;\n\t\tdata.type = typeName;\n\t\tdata.typeName = typeName;\n\t\tdata.originalType = originalTypeName;\n\t\tdata.similarType = originalTypeName === 'string' && ['text', 'html'].includes(typeName);\n\t\tdata.isHTML = typeName === 'html' || originalTypeName === 'string' && value[0] === '<';\n\t\tdata.isLongString = typeName === 'html' || typeName === 'text' || originalTypeName === 'string' && (data.value.length > 16 || data.value.indexOf('\\n') >= 0);\n\t\tdata.isUnsupported = !ValueEditor.supportedTypes.includes(typeId);\n\t\tdata.isActor = doc instanceof Actor;\n\t\tdata.isItem = doc instanceof Item;\n\t\t// data.isEditable = !data.isUnsupported;\n\t\t// data.isOwner = doc.isOwner;\n\t\tdata.simpleType = ['number', 'string', 'boolean'].includes(typeName);\n\t\tdata.deadType = ['null', 'undefined'].includes(typeName);\n\t\tdata.selectedType = this._type;\n\t\tdata.types = {\n\t\t\tnumber: 'Number',\n\t\t\tboolean: 'Boolean',\n\t\t\tstring: 'String',\n\t\t\tnull: 'Null',\n\t\t\tundefined: 'Undefined',\n\t\t\ttext: 'Text Block',\n\t\t\thtml: 'HTML (TinyMCE)'\n\t\t};\n\n\t\tdata.isToken = this.isToken;\n\n\t\tdata.TYPES = DATA_TYPES;\n\t\treturn data;\n\t}\n\n\t/**\n\t * @param {JQuery} jq\n\t */\n\tactivateListeners(jq) {\n\t\tsuper.activateListeners(jq);\n\t\tconst html = jq[0];\n\t\tconst app = this;\n\n\t\tconst parentApp = this.parentApp;\n\n\t\tconst isToken = this.isToken;\n\n\t\thtml.querySelector('select[name=\"type\"]')?.addEventListener('change', (ev) => {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tconst oldType = this._type,\n\t\t\t\tnewType = ev.target.value;\n\t\t\tthis._type = newType;\n\t\t\t// console.log('Changing type from', oldType, 'to', newType);\n\t\t\tthis.render();\n\t\t});\n\n\t\t// Fix weird 17px enforced height\n\t\tconst htmlEditor = html.querySelector('.editor > .tox');\n\t\tif (htmlEditor) htmlEditor.style.height = '100%';\n\n\t\t// Type swapping\n\t\thtml.querySelector('select[name=\"type\"]')\n\t\t\t?.addEventListener('change', function (ev) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\tapp._type = this.value;\n\t\t\t\tapp.render(true);\n\t\t\t});\n\n\t\tconst doc = this.document,\n\t\t\tpath = this._path;\n\n\t\t// Delete button listener\n\t\thtml.querySelector('button.delete')\n\t\t\t?.addEventListener('click', ev => {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\n\t\t\t\tconst dv = path.replace(/([^.]+)$/, (m) => `-=${m}`);\n\t\t\t\tconst updateData = { [dv]: null };\n\t\t\t\tconsole.log('Delete:', updateData);\n\n\t\t\t\tDialog.confirm({\n\t\t\t\t\ttitle: 'Delete data?',\n\t\t\t\t\tcontent: `<p>Delete: <code>${path}</code></p>`,\n\t\t\t\t\tyes: async () => {\n\t\t\t\t\t\tconst v10 = game.release.generation >= 10;\n\t\t\t\t\t\tif (!v10 && isToken) doc.token._actor = null; // HACK: \"Fixes\" synthetic actors on v9\n\n\t\t\t\t\t\tconst end = () => {\n\t\t\t\t\t\t\tapp.close();\n\n\t\t\t\t\t\t\t// HACK: v9 unlinked tokens\n\t\t\t\t\t\t\tif (!v10 && isToken)\n\t\t\t\t\t\t\t\tparentApp.reAssociate(doc.token.actor);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdoc.update(updateData)\n\t\t\t\t\t\t\t.then(_ => end())\n\t\t\t\t\t\t\t.catch(_ => end());\n\t\t\t\t\t},\n\t\t\t\t\tdefaultYes: false\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\t_updateObject(event, formData) {\n\t\t// delete formData.type;\n\t\tconst type = this._type,\n\t\t\tpath = this._path,\n\t\t\tdoc = this.document;\n\t\tlet value = formData.value;\n\t\tif (type === 'undefined') value = undefined;\n\t\telse if (type === 'null') value = null;\n\n\t\tconsole.log('Setting data:', type, path, value);\n\n\t\tconst updateData = { [path]: value };\n\t\t// console.log('UpdateData:', updateData);\n\n\t\tdoc.update(updateData).then(_ => this.close());\n\n\t\t// this.render();\n\t}\n\n\t/**\n\t * @override\n\t */\n\tasync close(opts) {\n\t\t// Unregister updates\n\t\t// delete this.document.apps[this.appId];\n\t\treturn super.close(opts);\n\t}\n}\n", "import { getTypeId, DATA_TYPES, DATA_TYPE_INVERTED } from './common.mjs';\nimport { systemPrefix, isEmpty } from './compat.mjs';\n\nconst dataKeySorter = (a, b) => a.key.localeCompare(b.key);\n\nclass ChildKeyData {\n\tkey;\n\ttype;\n\tconstructor(key, type) {\n\t\tthis.key = key;\n\t\tthis.type = type;\n\t}\n}\n\nexport class DataStructure {\n\t/** @type {String} */\n\tkey;\n\t/** @type {String} */\n\tpath;\n\n\t/** @type {String} */\n\ttype;\n\t/** @type {Number} */\n\ttypeId;\n\n\t/** @type {DataStructure} */\n\troot;\n\n\t/** @type {*} */\n\tvalue;\n\n\t/** @type {DataStructure} */\n\tparent;\n\t/** @type {DataStructure[]} */\n\tchildren = [];\n\t/** @type {Number} */\n\tdepth = 0;\n\t/** @type {String} */\n\ttreetype;\n\n\tget isRollData() {\n\t\treturn this.root.treetype === 'rolldata';\n\t}\n\n\t/** @type {Object|undefined} */\n\t_sourceData;\n\t/** @type {Object|undefined} */\n\t_derivedData;\n\t/** @type {Object|undefined} */\n\t_rollData;\n\t/** @type {object|undefined} */\n\t_overides;\n\n\t/** @type {Boolean} */\n\tstatic includeFunctions = false;\n\n\t/** @type {Boolean} */\n\tget isBigString() { return this.typeId === DATA_TYPES.string && this.value?.length > 24; }\n\n\t/** @type {Boolean} */\n\tget isNull() { return this.typeId === DATA_TYPES.null; }\n\n\t/** @type {Boolean} */\n\tget isFunction() { return this.typeId === DATA_TYPES.function; }\n\n\t/** @type {Boolean} */\n\tget isGetter() { return this.typeId === DATA_TYPES.getter; }\n\n\t/** @type {Boolean} */\n\tget isUndefined() { return this.typeId === DATA_TYPES.undefined; }\n\n\t/** @type {Boolean} */\n\tget isNullish() {\n\t\tif ([DATA_TYPES.null, DATA_TYPES.undefined].includes(this.typeId)) return true;\n\t\tif (this.isArray && this.value.length === 0) return true;\n\t\tif (this.isMap && this.value.size == 0) return true;\n\t\treturn false;\n\t}\n\n\t/** @type {Boolean} */\n\tget isArray() { return this.typeId === DATA_TYPES.array; }\n\n\tget isMap() { return this.typeId === DATA_TYPES.map; }\n\n\t/** @type {Boolean} */\n\tget isObject() { return this.typeId === DATA_TYPES.object; }\n\n\t/** @type {Boolean} */\n\tget isDocument() { return [DATA_TYPES.document, DATA_TYPES.data].includes(this.typeId); }\n\n\tget documentId() {\n\t\tif (this.typeId === DATA_TYPES.data) return this.value._id;\n\t\tif (this.typeId === DATA_TYPES.document) return this.value.id;\n\t\treturn undefined;\n\t}\n\n\t/** @type {String} */\n\tget className() { return this.value.__proto__.constructor.name; }\n\n\t/** @type {Boolean} */\n\tget isEmpty() {\n\t\tif (this.isNullish) return true;\n\t\tif (this.typeId === DATA_TYPES.array) return this.value.length == 0;\n\t\tif (this.typeId === DATA_TYPES.object) return isEmpty(this.value);\n\t\tif (this.typeId === DATA_TYPES.map) return this.value.size === 0;\n\t\tif (this.typeId === DATA_TYPES.custom) \treturn this.children.length == 0;\n\t\treturn false;\n\t}\n\n\t/** @type {Boolean} */\n\tget isString() { return this.typeId === DATA_TYPES.string; }\n\n\t/** @type {Boolean} */\n\tget isNumber() { return this.typeId === DATA_TYPES.number; }\n\n\t/** @type {Boolean} */\n\tget inArray() { return this.parent?.isArray ?? false; }\n\n\t/** @type {Boolean} */\n\tget isContainer() { return [DATA_TYPES.array, DATA_TYPES.object, DATA_TYPES.map, DATA_TYPES.custom].includes(this.typeId); }\n\n\t/** @type {Boolean} */\n\tget isCustom() { return this.typeId === DATA_TYPES.custom; }\n\n\t/** @type {String} */\n\tget formattedValue() {\n\t\tif (this.typeId === DATA_TYPES.undefined) return 'undefined';\n\t\tif (this.typeId === DATA_TYPES.null) return 'null';\n\t\tif (this.typeId === DATA_TYPES.function) {\n\t\t\t// console.log(this.path, 'FUNCTION', { fn: this.value });\n\t\t\treturn 'function';\n\t\t}\n\t\treturn this.value;\n\t}\n\n\t#inRoll;\n\t/** @type {Boolean} */\n\tget inRollData() {\n\t\tif (this.#inRoll === undefined) {\n\t\t\tif (this.root.treetype === 'rolldata') return this.#inRoll = true;\n\t\t\tif (!this.root._rollData) return false;\n\t\t\ttry {\n\t\t\t\treturn this.#inRoll = hasProperty(this.root._rollData, this.path);\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\t/* hasProperty() doesn't like \"invalid\" data  */\n\t\t\t}\n\t\t\treturn this.#inRoll = 3;\n\t\t}\n\t\treturn this.#inRoll;\n\t}\n\n\trollDataPathToSystem(path) {\n\t\tif (this.isRollData) {\n\t\t\tconst prefix = systemPrefix();\n\t\t\treturn `${prefix}.${path}`;\n\t\t}\n\t\telse return path;\n\t}\n\n\t#inSource;\n\t/** @type {Boolean} */\n\tget inSourceData() {\n\t\tif (this.#inSource === undefined) {\n\t\t\tif (this.root.treetype === 'source') return this.#inSource = true;\n\t\t\tif (!this.root._sourceData) return false;\n\t\t\tconst path = this.rollDataPathToSystem(this.path);\n\t\t\ttry {\n\t\t\t\tconst data = this.root._sourceData;\n\t\t\t\treturn this.#inSource = hasProperty(data, path);\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\t/* hasProperty() doesn't like \"invalid\" data  */\n\t\t\t}\n\t\t\treturn this.#inSource = 3;\n\t\t}\n\t\treturn this.#inSource;\n\t}\n\n\t#inDerived;\n\t/** @type {Boolean} */\n\tget inDerivedData() {\n\t\tif (this.#inDerived === undefined) {\n\t\t\tif (this.root.treetype === 'derived') return this.#inDerived = true;\n\t\t\tif (!this.root._derivedData) return false;\n\t\t\tconst path = this.rollDataPathToSystem(this.path);\n\t\t\ttry {\n\t\t\t\tconst data = this.root._derivedData;\n\t\t\t\treturn this.#inDerived = hasProperty(data, path);\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\t/* hasProperty() doesn't like \"invalid\" data  */\n\t\t\t}\n\t\t\treturn this.#inDerived = 3;\n\t\t}\n\t\treturn this.#inDerived;\n\t}\n\n\t#inTemporary;\n\tget inTemporaryData() {\n\t\tif (this.#inTemporary === undefined) {\n\t\t\tif (!this.root._temporaryData) return false;\n\t\t\tconst path = this.rollDataPathToSystem(this.path);\n\t\t\ttry {\n\t\t\t\tconst data = this.root._temporaryData;\n\t\t\t\treturn this.#inTemporary = hasProperty(data, path);\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\t/* hasProperty() doesn't like \"invalid\" data  */\n\t\t\t}\n\t\t\treturn this.#inTemporary = 3;\n\t\t}\n\t\treturn this.#inTemporary;\n\t}\n\n\tget hasOverrides() {\n\t\treturn !!this._overrides;\n\t}\n\n\t/** @type {String} */\n\tget css() {\n\t\tif (this.typeId === DATA_TYPES.boolean)\n\t\t\treturn this.value ? 'true' : 'false';\n\t\tif (this.typeId === DATA_TYPES.number)\n\t\t\treturn this.value === 0 ? 'zero' : this.value < 0 ? 'negative' : 'positive';\n\t\treturn '';\n\t}\n\n\tconstructor({ key, path, value, parent, type, treeType, depth }) {\n\t\tthis.key = key;\n\t\tthis.path = path;\n\t\tthis.typeId = type ?? getTypeId(value);\n\t\tthis.type = DATA_TYPE_INVERTED[this.typeId];\n\t\tthis.value = value;\n\t\tthis.parent = parent;\n\t\tthis.root = parent?.root ?? parent;\n\t\tthis.depth = depth;\n\t\tthis.treetype = treeType;\n\t\t// if (this.typeId === DATA_TYPES.custom) console.log(this.type, this.typeId, value, value.constructor.name);\n\t}\n\n\t#childKeys;\n\t/** @type {ChildKeyData[]} */\n\tchildKeys() {\n\t\tif (this.#childKeys) return this.#childKeys;\n\t\tif (this.isDocument) return [];\n\t\tswitch (this.typeId) {\n\t\t\tcase DATA_TYPES.array: return this.#childKeys = [this.value.map(k => new ChildKeyData(k))];\n\t\t\tcase DATA_TYPES.map: return this.#childKeys = [Array.from(this.value.keys()).map(k => new ChildKeyData(k))];\n\t\t\tcase DATA_TYPES.object:\n\t\t\tcase DATA_TYPES.custom: {\n\t\t\t\tconst allKeys = [], rvg = [], rvf = [];\n\t\t\t\tallKeys.push(...Object.getOwnPropertyNames(this.value).map(k => new ChildKeyData(k)));\n\n\t\t\t\tif (DataStructure.includeFunctions) {\n\t\t\t\t\t// Find getters also\n\t\t\t\t\tlet proto = this.value;\n\t\t\t\t\tconst ignored = ['constructor', 'toString', 'almostEqual', '__proto__', 'prototype', 'between'];\n\t\t\t\t\tdo {\n\t\t\t\t\t\tif (proto.constructor.name === 'Object') break;\n\t\t\t\t\t\tconst keys = Object.getOwnPropertyNames(proto);\n\t\t\t\t\t\tfor (const key of keys) {\n\t\t\t\t\t\t\tif (ignored.includes(key)) continue;\n\t\t\t\t\t\t\tconst desc = Object.getOwnPropertyDescriptor(proto, key);\n\t\t\t\t\t\t\tif (!desc) continue; // ?\n\n\t\t\t\t\t\t\tif (desc.get !== undefined)\n\t\t\t\t\t\t\t\trvg.push(new ChildKeyData(key, DATA_TYPES.getter));\n\t\t\t\t\t\t\telse if (typeof desc.value === 'function')\n\t\t\t\t\t\t\t\trvf.push(new ChildKeyData(key, DATA_TYPES.function));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tproto = Object.getPrototypeOf(proto);\n\t\t\t\t\t}\n\t\t\t\t\twhile (proto);\n\t\t\t\t}\n\t\t\t\treturn this.#childKeys = [allKeys.sort(dataKeySorter), rvg.sort(dataKeySorter), rvf.sort(dataKeySorter)];\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\treturn this.#childKeys = [];\n\t\t}\n\t}\n\n\tfillChildren() {\n\t\tconst curpath = this.path,\n\t\t\tbasePath = curpath?.length ? curpath : this.key,\n\t\t\tisArray = this.isArray,\n\t\t\tisMap = this.isMap;\n\n\t\tconst parseChildren = (list) => {\n\t\t\tlist?.forEach((ckData, i) => {\n\t\t\t\tconst { key, type } = ckData;\n\t\t\t\tconst trueKey = !isArray ? key : i,\n\t\t\t\t\tvalue = isMap ? this.value.get(trueKey) : this.value[trueKey];\n\t\t\t\tconst path = basePath ? `${basePath}.${trueKey}` : trueKey;\n\n\t\t\t\tconst rv = Hooks.call('data-inspector.filterData', this.root.document, path, this.treetype);\n\t\t\t\tif (rv === false) return;\n\n\t\t\t\tconst typeId = getTypeId(value);\n\t\t\t\tif (typeId === DATA_TYPES.function && !DataStructure.includeFunctions) return;\n\t\t\t\tconst c = new DataStructure({ key: trueKey, path, value, parent: this, type, depth: this.depth + 1 });\n\t\t\t\tthis.children.push(c);\n\t\t\t});\n\t\t}\n\n\t\tconst [all, functions, getters] = this.childKeys();\n\n\t\tparseChildren(all);\n\t\tparseChildren(functions);\n\t\tparseChildren(getters);\n\n\t\treturn this.children;\n\t}\n\n\tstatic recurse(sourceData, key, path, type, { includeFunctions = false, document } = {}) {\n\t\tDataStructure.includeFunctions = includeFunctions ?? false;\n\n\t\tconst dt = new DataStructure({ key, path, value: sourceData, parent: null, treeType: type, depth: 0 });\n\t\tdt.document = document;\n\t\tdt.root = dt;\n\t\tconst all = {};\n\t\tif (dt.path) all[dt.path] = dt;\n\t\tlet itemCount = 0, error = false;\n\n\t\t/**\n\t\t * @param {DataStructure} cdt\n\t\t */\n\t\tfunction recurseChildren(cdt) {\n\t\t\tcdt.fillChildren().forEach(oo => {\n\t\t\t\tall[oo.path] = oo;\n\t\t\t\titemCount++;\n\t\t\t\tif (itemCount > 25000) {\n\t\t\t\t\tif (!error) {\n\t\t\t\t\t\tui.notifications.error('DATA INSPECTOR | Possible cyclic reference encountered; ending inspection early');\n\t\t\t\t\t\tconsole.error(oo.path, '\\nDATA INSPECTOR | Possible cyclic reference encountered; ending inspection early\\n', oo);\n\t\t\t\t\t\terror = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn; // Arbitrary hard exit\n\t\t\t\t}\n\t\t\t\trecurseChildren(oo);\n\t\t\t});\n\t\t}\n\n\t\trecurseChildren(dt);\n\n\t\treturn { root: dt, all };\n\t}\n\n\t/*\n\thasChild(path) {\n\t\tconst parts = path.split('.');\n\t}\n\t*/\n\n\t/**\n\t * @param {String} path\n\t * @returns {DataStructure}\n\t */\n\tgetAtPath(path) {\n\t\tconst parts = path.split('.');\n\t\tconst key = parts.shift();\n\n\t\tconst getPart = () => {\n\t\t\tswitch (this.typeId) {\n\t\t\t\tcase DATA_TYPES.array: return this.children[parseInt(key)];\n\t\t\t\tdefault: return this.children.find(cd => cd.key === key);\n\t\t\t}\n\t\t};\n\n\t\tconst c = getPart();\n\n\t\tif (parts.length === 0) return c;\n\t\telse return c?.getAtPath(parts.join('.'));\n\t}\n}\n", "import { CFG, copyToClipboard, getTypeName, getTypeId, DATA_TYPES, DATA_TYPE_INVERTED } from './common.mjs';\nimport { systemPrefix, getDocData } from './compat.mjs';\nimport { ValueEditor } from './editor.mjs';\nimport { DataStructure } from './data-structure.mjs';\n\nfunction createTemporaryDocument(doc) {\n\tconst prefix = systemPrefix();\n\tconst data = { name: doc.name + ' [Temporary]', type: doc.type, [prefix]: { } };\n\tHooks.call('data-inspector.temporaryData', doc, data);\n\treturn doc instanceof Actor ? new Actor(data) : new Item(data);\n}\n\nclass SearchResult {\n\t/** @type {String} */\n\tpath;\n\n\t/** @type {Boolean} */\n\tkeyFocus = true;\n\n\t/** @type {Boolean} */\n\tmatch;\n\n\t/** @type {Boolean} */\n\tget mismatch() { return this.indexes.path.length === 0; }\n\n\t/**\n\t * Search target, what is being looked for.\n\t *\n\t * @type {Object}\n\t */\n\ttarget;\n\t/** @type {Number} */\n\tscore;\n\n\t/** @type {Boolean} */\n\tkeyFullMatch;\n\t/** @type {Boolean} */\n\tpathFullMatch;\n\n\tindexes = {\n\t\t/** @type {Number[]} */\n\t\tpath: [],\n\t\t/** @type {Number[]} */\n\t\tkey: [],\n\t};\n\n\t/** @type {Number} */\n\tratio;\n\t/** @type {Boolean} */\n\tget good() { return this.ratio > 0.8; }\n\t/** @type {Boolean} */\n\tget bad() { return this.ratio < 0.3; }\n\tscoring = {\n\t\t/** @type {Number} */\n\t\tfull: undefined,\n\t\t/** @type {Number} */\n\t\tkey: undefined,\n\t};\n\n\tconstructor({ path, match, target, score, keyFocus, keyFullMatch, pathFullMatch, pathIndexes, keyIndexes, ratio, scoring } = {}) {\n\t\tthis.path = path;\n\t\tthis.match = match;\n\t\tthis.target = target;\n\n\t\tthis.keyFocus = keyFocus;\n\n\t\tthis.score = score;\n\t\tthis.keyFullMatch = keyFullMatch;\n\t\tthis.pathFullMatch = pathFullMatch;\n\t\tthis.indexes.path = pathIndexes;\n\t\tthis.indexes.key = keyIndexes;\n\n\t\tthis.ratio = ratio;\n\n\t\tthis.scoring = scoring;\n\t}\n}\n\nclass TermMatch {\n\t/** @type {Number} */\n\tscore;\n\t/** @type {Number[]} */\n\tindexes;\n\tfull;\n\thalf;\n\t/** @type {Number} */\n\tratio;\n\t/** @type {Number} */\n\tconsecutives;\n\t/** @type {Number} */\n\tlongestChain;\n\t/** @type {Score[]} */\n\tscoring;\n\n\tconstructor({ indexes, full, half, ratio, consecutives, longestChain, scoring } = {}) {\n\t\tthis.indexes = indexes;\n\t\tthis.full = full;\n\t\tthis.half = half;\n\t\tthis.ratio = ratio;\n\t\tthis.consecutives = consecutives;\n\t\tthis.longestChain = longestChain;\n\t\tthis.scoring = scoring;\n\t\tthis.score = scoring.reduce((old, scr) => old + scr.value);\n\t}\n}\n\nclass Score {\n\t/** @type {Number} */\n\tvalue;\n\t/** @type {String} */\n\tdescription;\n\n\t/**\n\t * @param {Number} value\n\t * @param {String} description\n\t */\n\tconstructor(value, description) {\n\t\tthis.value = value;\n\t\tthis.description = description;\n\t}\n}\n\nexport class DataInspectorDialog extends FormApplication {\n\t_path = '';\n\t/** @type {Element} */\n\t_pathEl;\n\t_search = '';\n\t_searchEnd = true;\n\t_functions = false;\n\t_document = false;\n\t_mode = 'rolldata';\n\t_expandedItems = new Set();\n\t_derivedData;\n\t_sourceData;\n\t_temporaryData;\n\t_rollData;\n\t_overrides;\n\t_resultQuality = 0.7;\n\t/** @type {DataStructure} */\n\troot;\n\t/** @type {Actor} */\n\tparentActor;\n\n\tpaths;\n\n\tconstructor(document, options = {}) {\n\t\tconst title = ['Data Inspector'];\n\n\t\tlet parent = null;\n\t\tif (document.actor) parent = document.actor;\n\n\t\tif (parent) title.push(parent.name);\n\n\t\ttitle.push(document.name);\n\n\t\toptions.title = title.join(': ');\n\t\toptions.id = 'lil-data-inspector-' + document.uuid;\n\n\t\tsuper(document, options);\n\n\t\tthis._functions = game.settings.get(CFG.module, CFG.SETTINGS.functions);\n\t\tthis._resultQuality = game.settings.get(CFG.module, CFG.SETTINGS.results);\n\t\tthis._mode = game.settings.get(CFG.module, CFG.SETTINGS.mode);\n\n\t\tthis.document = document;\n\t\tthis.parentActor = parent;\n\n\t\t// Register for item updates\n\t\tdocument.apps[this.appId] = this;\n\t}\n\n\tget template() { return `modules/${CFG.module}/template/inspector.hbs`; }\n\n\tstatic get defaultOptions() {\n\t\tconst _default = super.defaultOptions;\n\t\treturn mergeObject(_default, {\n\t\t\ttitle: 'Data Inspector',\n\t\t\tclasses: [..._default.classes, 'koboldworks', 'data-inspector'],\n\t\t\tresizable: true,\n\t\t\twidth: 520,\n\t\t\theight: 620,\n\t\t\tscrollY: ['div.data'],\n\t\t});\n\t}\n\n\tgetDataVariant(doc, mode) {\n\t\tconst v10 = game.release.generation >= 10; // v9/v10 compatibility\n\t\tswitch (mode ?? this._mode) {\n\t\t\tdefault:\n\t\t\tcase 'mixed':\n\t\t\t\tif (this._rollData == null) this._rollData = doc.getRollData();\n\t\t\t\tif (this._sourceData == null) this._sourceData = doc.toObject();\n\t\t\t\tif (this._derivedData == null) this._derivedData = getDocData(doc);\n\t\t\t\tif (this._overrides == null) this._overrides = v10 ? doc.token?.actorData : doc.token?.data.actorData;\n\t\t\t\treturn {};\n\t\t\tcase 'override':\n\t\t\t\tif (this._overrides == null) this._overrides = v10 ? doc.token?.actorData : doc.token?.data.actorData;\n\t\t\t\treturn this._overrides;\n\t\t\tcase 'rolldata':\n\t\t\t\tif (this._rollData == null) this._rollData = doc.getRollData();\n\t\t\t\treturn this._rollData;\n\t\t\tcase 'source':\n\t\t\t\tif (this._sourceData == null) this._sourceData = doc.toObject();\n\t\t\t\treturn this._sourceData;\n\t\t\tcase 'derived': {\n\t\t\t\tif (this._derivedData == null) this._derivedData = getDocData(doc);\n\t\t\t\treturn this._derivedData;\n\t\t\t}\n\t\t}\n\t}\n\n\t// v9 unlinked token helper\n\treAssociate(doc) {\n\t\tthis.document = doc;\n\t\tdoc.apps[this.appId] = this;\n\t\tthis.render();\n\t}\n\n\tgetData() {\n\t\tconst data = super.getData(),\n\t\t\tdoc = this.document,\n\t\t\tisActor = doc instanceof Actor,\n\t\t\ttype = doc.type,\n\t\t\ttypeLabelKey = `${isActor ? 'ACTOR' : 'ITEM'}.Type${type.capitalize()}`,\n\t\t\ttypeLabel = game.i18n.localize(typeLabelKey);\n\n\t\tif (this._mode === 'source') {\n\t\t\tthis._temporaryData ??= createTemporaryDocument(this.document).toObject();\n\t\t}\n\n\t\tconst prefix = systemPrefix();\n\t\t// Include prefix to mimic other data structures for easier handling all around (no need for special cases)\n\t\tdata.rolldata = { [prefix]: this.getDataVariant(doc, 'rolldata') };\n\t\tdata.sourcedata = this.getDataVariant(doc, 'source');\n\t\tdata.derived = this.getDataVariant(doc, 'derived');\n\t\tdata.overrides = this.getDataVariant(doc, 'override');\n\n\t\tconst docData = this.getDataVariant(doc);\n\n\t\tdata.document = doc;\n\t\t// data.overrides = doc.overrides;\n\t\tdata.type = type;\n\t\tdata.typeLabel = typeLabel;\n\t\tdata.docType = doc.constructor.name;\n\t\tdata.dataType = this._mode;\n\t\tdata.isRollData = this._mode === 'rolldata';\n\t\tdata.isSourceData = this._mode === 'source';\n\t\tdata.isDerivedData = this._mode === 'derived';\n\t\tdata.isOverrideData = this._mode === 'override';\n\t\tdata.resultQuality = this._resultQuality;\n\t\tconst isRollData = this._mode === 'rolldata';\n\n\t\tconst basePath = isRollData ? null : prefix;\n\t\tconst { root, all } = DataStructure.recurse(isRollData ? docData : docData[prefix], basePath, basePath, this._mode, { includeFunctions: this._functions, document: doc });\n\t\tdata.data = root;\n\t\tthis.root = root;\n\n\t\troot._sourceData = data.sourcedata;\n\t\troot._derivedData = data.derived;\n\t\troot._rollData = data.rolldata;\n\t\troot._overrides = data.overrides;\n\t\troot._temporaryData = this._temporaryData;\n\n\t\tif (this._mode === 'rolldata') {\n\t\t\tdata.sourcedata = getDocData(data.sourcedata);\n\t\t\tdata.derived = getDocData(data.derived);\n\t\t}\n\n\t\tdata.uuid = doc.uuid;\n\t\tdata.search = this._search;\n\t\tdata.searchEnd = this._searchEnd;\n\t\tdata.includeFunctions = this._functions;\n\t\tdata.includeDocument = this._document;\n\t\tdata.path = this._path;\n\n\t\tdata.TYPES = DATA_TYPES;\n\n\t\treturn data;\n\t}\n\n\t/**\n\t * @param {Element} el\n\t * @param {elementHandler} callback\n\t * @param {args} Arguments\n\t */\n\ttreeWalker(el, callback, ...args) {\n\t\tcallback(el, ...args);\n\t\tconst parent = el.parentElement;\n\t\tif (parent && ['LI', 'UL'].includes(parent.tagName))\n\t\t\tthis.treeWalker(parent, callback, ...args);\n\t}\n\n\thighlightEl(el, enabled = true) {\n\t\t// console.log('Highlighting!');\n\t\tif (this._pathEl) this._pathEl.classList.toggle('selected', false);\n\t\tel.classList.toggle('selected', enabled);\n\t\tthis._pathEl = el;\n\t}\n\n\texpandDataElTree(el) {\n\t\tthis.treeWalker(el, this.expandDataEl, false, true);\n\t}\n\n\t/**\n\t * @param {Element} el\n\t */\n\texpandDataEl(el, record = true, expand = undefined) {\n\t\tel.classList.toggle('hide', false);\n\n\t\tif (el.classList.contains('value') || el.classList.contains('empty')) {\n\t\t\t// console.log('Don\\'t expand empty or value entry');\n\t\t\treturn;\n\t\t}\n\n\t\t// Record open state\n\t\tif (record) {\n\t\t\tconst path = el.dataset.path;\n\t\t\tconst items = this._expandedItems;\n\t\t\tel.classList.contains('collapsed') ? items.add(path) : items.delete(path);\n\t\t}\n\n\t\t// Toggle collapse\n\t\tel.classList.toggle('collapsed', expand !== undefined ? !expand : undefined);\n\t\tel.classList.toggle('expanded', expand);\n\t}\n\n\t/**\n\t * @param {Element} el\n\t */\n\tcollapseAndClearEl(el, hide = false, includeValues = false) {\n\t\tel.classList.toggle('hide', hide);\n\t\tel.dataset.matchQuality = null;\n\t\tel.classList.toggle('selected', false);\n\t\tif (el.classList.contains('value') || el.classList.contains('empty')) return;\n\t\tel.classList.toggle('collapsed', true);\n\t\tel.classList.toggle('expanded', false);\n\t}\n\n\t/**\n\t * @param {Event} ev\n\t */\n\texpandData(ev, el) {\n\t\tev.preventDefault();\n\t\tev.stopPropagation();\n\t\tthis.expandDataEl(el);\n\t}\n\n\t/**\n\t * @param {JQuery} jq\n\t */\n\tactivateListeners(jq) {\n\t\tsuper.activateListeners(jq);\n\n\t\tconst html = jq[0];\n\n\t\tconst header = html.querySelector('.header');\n\n\t\tconst appEl = html.closest('[data-appid]');\n\t\tif (appEl) {\n\t\t\tconst doc = this.document;\n\t\t\tconst item = doc instanceof Item ? doc : null;\n\t\t\tif (item) {\n\t\t\t\tappEl.dataset.itemId = item.id;\n\t\t\t\tappEl.dataset.itemUuid = item.uuid;\n\t\t\t}\n\n\t\t\tconst actor = doc instanceof Actor ? doc : this.parentActor;\n\t\t\tif (actor) {\n\t\t\t\tappEl.dataset.actorId = actor.id;\n\t\t\t\tappEl.dataset.actorUuid = actor.uuid;\n\t\t\t}\n\t\t}\n\n\t\tconst pathInput = header.querySelector('input.path');\n\t\tconst app = this;\n\t\tconst rolldata = this._mode === 'rolldata';\n\t\tconst rawdata = this._mode === 'source';\n\n\t\t/**\n\t\t * @param {Event} ev\n\t\t */\n\t\tfunction changeDataSource(ev) {\n\t\t\tconst value = ev.target.value;\n\t\t\tif (app._mode !== value) {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\tev.target.disabled = true;\n\n\t\t\t\t// Convert path to new mode\n\t\t\t\tconst path = app._path;\n\t\t\t\tif (path.length > 0) {\n\t\t\t\t\tconst pathp = path.split('');\n\t\t\t\t\tconst prefix = `${systemPrefix()}.`;\n\t\t\t\t\tif (path[0] === '@' && app._mode === 'rolldata')\n\t\t\t\t\t\tpathp.splice(0, 1, prefix);\n\t\t\t\t\telse if (path.length > 5 && path.startsWith(prefix) && value === 'rolldata')\n\t\t\t\t\t\tpathp.splice(0, prefix.length, '@');\n\t\t\t\t\tapp._path = pathp.join('');\n\t\t\t\t}\n\n\t\t\t\t// Swap mode\n\t\t\t\tapp._path = app.getBasePath(app._path, app._mode);\n\t\t\t\tapp._mode = value;\n\t\t\t\tapp._lastSearch = undefined;\n\t\t\t\tapp.render(false, { keepCache: true });\n\t\t\t}\n\t\t}\n\n\t\theader.querySelector('select.type').addEventListener('change', changeDataSource);\n\n\t\tfunction changeSearchQuality(ev) {\n\t\t\t// console.log('Quality:', this.value);\n\t\t\tapp._resultQuality = Number(this.value);\n\t\t\tif (app._search.length > 0) app.doSearch(app._search, { forceRefresh: true });\n\t\t}\n\n\t\theader.querySelector('input.search-quality').addEventListener('change', changeSearchQuality);\n\n\t\tfunction copyPath(ev) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tconst el = this;\n\t\t\tconst path = el.dataset.path;\n\t\t\tconst properPath = rolldata ? `@${path}` : path;\n\t\t\tpathInput.value = properPath;\n\t\t\tapp._path = properPath;\n\t\t\tapp.highlightEl(el, true);\n\t\t\tif (window.isSecureContext) // Required by clipboard\n\t\t\t\treturn copyToClipboard(properPath); // .then(_ => ui.notifications?.info(`\"${properPath}\" copied to clipboard`));\n\t\t}\n\n\t\tjq.on('click', '[data-path]', function (ev) { app.expandData(ev, this); });\n\t\tjq.on('contextmenu', '[data-path]', copyPath);\n\t\tpathInput.addEventListener('input', ev => this.debounceCustomPath(ev.target.value, ev, true))\n\t\tpathInput.addEventListener('change', ev => this.debounceCustomPath(ev.target.value, ev, false));\n\n\t\t// Open previously open paths\n\t\thtml.querySelectorAll('[data-path]').forEach(el => {\n\t\t\tconst path = el.dataset.path;\n\t\t\tif (this._expandedItems.has(path))\n\t\t\t\tthis.expandDataEl(el);\n\t\t});\n\n\t\t/*\n\t\thtml.querySelectorAll('.value[data-id]').forEach(el => {\n\t\t\tel.addEventListener('click', this._copyId);\n\t\t});\n\t\t*/\n\n\t\tconst dataSection = html.querySelector('form > .data');\n\t\tdataSection.addEventListener('dblclick', function openEditor(ev) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\n\t\t\tif (['source', 'override'].includes(app._mode)) {\n\t\t\t\tconst el = ev.target;\n\t\t\t\tconst ael = el.dataset.path ? el : el.closest('[data-path]');\n\t\t\t\tif (ael) app._openValueEditor(ev, ael.dataset.path);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tui.notifications.warn(`Editing not supported in \"${app._mode}\" mode!`);\n\t\t\t}\n\t\t});\n\t\t/*\n\t\tdataSection.querySelectorAll('.data-element[data-path]').forEach(el => {\n\t\t\tconst sel = el.querySelector('.details > .value');\n\t\t\tsel.addEventListener('dblclick', function (ev) { app._openValueEditor(ev, el.dataset.path); });\n\t\t});\n\t\t*/\n\n\t\tconst buildSearchCache = (el) => {\n\t\t\tconst path = el.dataset.path;\n\t\t\tconst key = el.dataset.key;\n\t\t\tconst label = el.querySelector('h4');\n\t\t\tthis.paths.set(path, {\n\t\t\t\tpath,\n\t\t\t\tkey,\n\t\t\t\telement: el,\n\t\t\t\tlabel: label.textContent,\n\t\t\t});\n\t\t}\n\n\t\tfunction updateTooltipData(el, tt) {\n\t\t\tconst p = el.getBoundingClientRect();\n\t\t\ttt.style.cssText += `--top:${p.bottom};--width:${tt.clientWidth};--p-left:${p.left};--height:${tt.clientHeight};--p-height:${p.height};--p-width:${p.width};--p-right:${p.right};--p-top:${p.top};`;\n\t\t}\n\n\t\tconst paths = dataSection.querySelectorAll('li[data-path]');\n\t\tconst pathPrefix = this._mode === 'rolldata' ? '@' : '';\n\t\tpaths.forEach(el => {\n\t\t\tconst dEl = el.querySelector('.details');\n\t\t\tdEl.addEventListener('mouseenter', ev => {\n\t\t\t\t// Add tooltip\n\t\t\t\t/** @type {Element} */\n\t\t\t\tconst tt = document.createElement('span');\n\t\t\t\ttt.classList.add('tooltip');\n\t\t\t\tdEl.classList.add('has-tooltip');\n\t\t\t\tconst path = el.dataset.path;\n\t\t\t\tconst ppath = pathPrefix + path;\n\n\t\t\t\tlet dpath = path;\n\t\t\t\tif (app._mode !== 'rolldata') {\n\t\t\t\t\tconst parts = path.split('.');\n\t\t\t\t\tparts.shift();\n\t\t\t\t\tdpath = parts.join('.');\n\t\t\t\t}\n\n\t\t\t\tconst v = this.root?.getAtPath(dpath);\n\t\t\t\tconst typeId = v.typeId;\n\t\t\t\tconst typeName = typeId !== DATA_TYPES.custom ? DATA_TYPE_INVERTED[typeId] : `{${v.className}}`;\n\n\t\t\t\t// const key = el.dataset.key;\n\t\t\t\tconst ttcontent = [\n\t\t\t\t\t'<label>Path</label>: <span class=\\'path\\'>',\n\t\t\t\t\tppath,\n\t\t\t\t\t'</span><br>',\n\t\t\t\t\t'<label>Type</label>: <span class=\\'type\\'>',\n\t\t\t\t\ttypeName,\n\t\t\t\t\t'</span><br>',\n\t\t\t\t];\n\n\t\t\t\tif ([DATA_TYPES.data, DATA_TYPES.document].includes(typeId)) {\n\t\t\t\t\tttcontent.push(\n\t\t\t\t\t\t'<label>Document ID</label>: <span class=\\'type\\'>',\n\t\t\t\t\t\tv.documentId,\n\t\t\t\t\t\t'</span><br>',\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tttcontent.push('<br>');\n\n\t\t\t\tconst inData = [];\n\t\t\t\tif (v.root.treetype !== 'rolldata') inData.push({ label: 'Roll Data', present: v.inRollData });\n\t\t\t\tif (v.root.treetype !== 'derived') inData.push({ label: 'Derived', present: v.inDerivedData });\n\t\t\t\tif (v.root.treetype !== 'source')\n\t\t\t\t\tinData.push({ label: 'Source', present: v.inSourceData });\n\t\t\t\telse\n\t\t\t\t\tinData.push({ label: 'Temporary', present: v.inTemporaryData });\n\n\t\t\t\tttcontent.push('<div class=\"in-data\">');\n\t\t\t\tfor (const d of inData) {\n\t\t\t\t\tttcontent.push('<div class=\"data-source\">', '<label class=\"header\">', d.label, '</label>', '<span class=\"value\">', d.present ? '\u2713' : '\u2717', '</span>', '</div>');\n\t\t\t\t}\n\t\t\t\tttcontent.push('</div>');\n\n\t\t\t\ttt.innerHTML = ttcontent.join('');\n\n\t\t\t\tdEl.prepend(tt);\n\n\t\t\t\tupdateTooltipData(el, tt);\n\n\t\t\t\t// Listener for fixing position\n\t\t\t\tel.addEventListener('mouseenter', () => updateTooltipData(el, tt), { passive: true });\n\t\t\t}, { passive: true, once: true });\n\t\t});\n\n\t\tconst search = header.querySelector('input.search');\n\t\tsearch.addEventListener('change', ev => this.debounceSearch(ev.target.value, ev, false), { passive: true });\n\t\tsearch.addEventListener('input', ev => this.debounceSearch(ev.target.value, ev, true), { passive: true });\n\n\t\tthis.paths = new Collection();\n\t\tpaths.forEach(el => buildSearchCache(el));\n\n\t\t/*\n\t\tconst sEnd = header.querySelector('input.search-end');\n\t\tsEnd.addEventListener('change', ev => {\n\t\t\tthis._searchEnd = ev.target.checked;\n\t\t\tthis.debounceSearch(this._search);\n\t\t});\n\t\t*/\n\n\t\tconst functions = header.querySelector('input.functions');\n\t\tfunctions.addEventListener('change', ev => {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\n\t\t\tthis._functions = ev.target.checked;\n\t\t\tthis.render();\n\t\t});\n\n\t\t/*\n\t\tconst indocument = header.querySelector('input.document');\n\t\tindocument.addEventListener('change', ev => {\n\t\t\tthis._document = ev.target.checked;\n\t\t\tthis.render();\n\t\t});\n\t\t*/\n\n\t\tif (this._search.length) this.debounceSearch(this._search);\n\n\t\tif (this._functions) {\n\t\t\tif (!this._getGetterValueBound) this._getGetterValueBound = this._getGetterValue.bind(this);\n\t\t\tdataSection.addEventListener('click', function (ev) {\n\t\t\t\tif (!ev.target.matches('.getter.value')) return;\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\tapp._getGetterValueBound(ev);\n\t\t\t});\n\t\t}\n\n\t\t// Always expand selected path\n\t\tthis.expandSelectedPath();\n\t}\n\n\t/**\n\t * @param {Event} event\n\t * @param {String} path\n\t */\n\t_openValueEditor(event, path) {\n\t\tif (!game.settings.get(CFG.module, CFG.SETTINGS.allowEditing))\n\t\t\treturn ui.notifications.warn('Editing has been disabled.');\n\n\t\tconst pp = path.split('.');\n\t\tconst docData = getDocData(this.document);\n\t\tlet currentData = docData;\n\n\t\twhile (pp.length > 0) {\n\t\t\tconst part = pp.shift();\n\t\t\tcurrentData = currentData[part];\n\t\t\tif (currentData == null && pp.length > 0)\n\t\t\t\treturn ui.notifications.warn(`Failed to navigate to the target datapath: ${path}`);\n\t\t\tif (Array.isArray(currentData) && pp.length > 0)\n\t\t\t\treturn ui.notifications.warn(`Editing arrays or values inside of arrays not supported: ${path}`);\n\t\t}\n\n\t\tconst type = getTypeId(currentData);\n\t\tconst isSupported = ValueEditor.supportedTypes.includes(type);\n\t\tif (!ValueEditor.supportedTypes.includes(type)) {\n\t\t\tconst allowUnsupported = game.settings.get(CFG.module, CFG.SETTINGS.allowEditingUnsupported);\n\t\t\tif (!allowUnsupported)\n\t\t\t\treturn ui.notifications.warn(`Unsupported type for editing: ${DATA_TYPE_INVERTED[type]}`);\n\t\t}\n\n\t\t// Things went okay\n\t\t// console.log('READY TO EDIT:', path, type, currentData);\n\t\tnew ValueEditor(this.document, path, type, { isToken: this._mode === 'override', app: this }).render(true, { focus: true });\n\t}\n\n\t_copyId(_event) {\n\t\tconst id = this.dataset.id;\n\t\tconsole.log('Copying ID:', id);\n\t\treturn copyToClipboard(id);\n\t}\n\n\t_getGetterValueBound;\n\n\t/**\n\t * @param {Event} event\n\t */\n\t_getGetterValue(event) {\n\t\tevent.stopImmediatePropagation();\n\t\tevent.preventDefault();\n\t\tconst target = event.target;\n\t\tif (!target) return;\n\t\ttarget.removeEventListener('click', this._getGetterValueBound);\n\t\tthis._resolveGetter(target);\n\t}\n\n\t/**\n\t * @param {Element} element\n\t */\n\t_resolveGetter(element) {\n\t\tconst el = element.dataset.path ? element : element.closest('[data-path]');\n\t\tif (!el) return;\n\t\t/** @type {String} */\n\t\tconst path = el.dataset.path;\n\n\t\t// console.log('Getter:', path, el);\n\t\tlet parentPath = path.split('.');\n\t\tparentPath.shift(); // remove data\n\t\tparentPath = parentPath.join('.');\n\t\t// console.log('Parentage:', parentPath);\n\t\tconst ds = this.root.getAtPath(parentPath);\n\t\tconst value = ds.value;\n\n\t\telement.textContent = value;\n\t\telement.classList.add('resolved');\n\t\tconst type = getTypeId(value);\n\t\tconst c = new DataStructure({ key: ds.key, path: ds.path, value, type });\n\t\telement.classList.add(c.type);\n\t\t// console.log('GET:', c);\n\t}\n\n\t/**\n\t * Strip @ and data. prefix\n\t * @param {String} path\n\t */\n\tgetBasePath(path, mode) {\n\t\tmode ??= this._mode;\n\t\tswitch (mode) {\n\t\t\tcase 'rolldata':\n\t\t\t\treturn path.replace(/^@/, '');\n\t\t\tdefault:\n\t\t\t\treturn path.substring(systemPrefix.length);\n\t\t}\n\t}\n\n\texpandSelectedPath() {\n\t\tif (this._path.length == 0) return;\n\n\t\tconst path = this.getBasePath(this._path);\n\n\t\t// console.log({ path, source: this._path, mode: this._mode });\n\t\tconst p = this.paths.get(path);\n\t\tif (p) {\n\t\t\tthis.expandDataElTree(p.element);\n\t\t\tthis._pathEl = p.element;\n\t\t\tthis.highlightEl(this._pathEl, true);\n\t\t\tthis._pathEl.scrollIntoView({ block: 'center' });\n\t\t}\n\t}\n\n\tinputDebounceDelay = 250;\n\tsearchDelayTimer;\n\tselectDelayTimer;\n\n\t/**\n\t * @param {String} search\n\t * @param {Event} event\n\t * @param {Boolean} active\n\t */\n\tdebounceSearch(search, event, active = false) {\n\t\tclearTimeout(this.searchDelayTimer);\n\t\t// Increase delay for short queries and shorten it for end of input\n\t\tif (search.length === 0) active = false;\n\t\tconst delay = Math.clamped(active ? search.length > 3 ? this.inputDebounceDelay : this.inputDebounceDelay * 2 : this.inputDebounceDelay / 2, 150, 500);\n\t\tthis.searchDelayTimer = setTimeout(_ => this.doSearch(search), delay);\n\t}\n\n\t/**\n\t * @param {String} input\n\t * @param {Event} event\n\t * @param {Boolean} active\n\t */\n\tdebounceCustomPath(input, event, active = false) {\n\t\tthis._path = input;\n\t\tif (this._pathEl) {\n\t\t\tthis._pathEl.classList.toggle('selected', false);\n\t\t\tthis._pathEl = null;\n\t\t}\n\t\tclearTimeout(this.selectDelayTimer);\n\t\tif (input.length === 0) active = false;\n\t\tconst delay = active ? input.length > 3 ? this.inputDebounceDelay : this.inputDebounceDelay * 2 : this.inputDebounceDelay / 2;\n\t\t// console.log('SelectDebounce:', search, delay);\n\t\tthis.selectDelayTimer = setTimeout(_ => this.selectCustomPath(input), delay);\n\t}\n\n\t/**\n\t * @param {String} input\n\t */\n\tselectCustomPath(input) {\n\t\tthis._path = input;\n\t\tthis.expandSelectedPath();\n\t\tconst path = this.paths.get(input);\n\t\t// console.log('SELECTING:', input, path);\n\t\tif (path) {\n\t\t\tthis.expandDataElTree(path.element);\n\t\t\tthis.highlightEl(path.element);\n\t\t\tthis._pathEl = path.element;\n\t\t}\n\t\telse {\n\t\t\tthis._pathEl = null;\n\t\t}\n\t}\n\n\t_lastSearch;\n\tlastEndSerch;\n\t/**\n\t * @param {String} search\n\t */\n\tdoSearch(search, { forceRefresh = false } = {}) {\n\t\tthis._search = search;\n\t\tconsole.log('Searching:', this._search);\n\n\t\tif (forceRefresh !== true && this._lastSearch === search && this.lastEndSerch === this._searchEnd) return;\n\n\t\tthis._lastSearch = search;\n\t\tthis.lastEndSerch = this._searchEnd;\n\n\t\tif (search.length == 0) {\n\t\t\tthis.paths.forEach(p => this.collapseAndClearEl(p.element, false));\n\t\t\tthis.expandSelectedPath();\n\t\t\treturn;\n\t\t}\n\n\t\t// console.log('DATA INSPECTOR |', Date.now(), 'Searching:', search, 'EndFocus:', this._searchEnd);\n\n\t\t// Collapse all first to ensure expansion happens smoothly\n\t\tthis.paths.forEach(p => this.collapseAndClearEl(p.element, true));\n\n\t\tconst term = search.toLowerCase().split('');\n\n\t\t// Do actual search\n\t\tfunction matchTerm(term, subject, { harsh = true } = {}) {\n\t\t\tconst indexes = [];\n\t\t\tconst subjectParts = subject.toLowerCase().split('');\n\t\t\tlet consecutives = 0, longestChain = 0;\n\t\t\tlet si = 0, sm = term[0], lastMatch = -2;\n\t\t\tlet lastChain = 1;\n\t\t\tconst scoring = [];\n\t\t\tconst updateLongestChain = () => {\n\t\t\t\tif (lastChain > longestChain) longestChain = lastChain;\n\t\t\t\tlastChain = 1;\n\t\t\t}\n\t\t\tfor (let i = 0; i < subjectParts.length; i++) {\n\t\t\t\tif (subjectParts[i] === sm) {\n\t\t\t\t\tindexes.push(i);\n\t\t\t\t\t// Give score for subsequent matches\n\t\t\t\t\tif (lastMatch === i - 1) {\n\t\t\t\t\t\tscoring.push(new Score(3, `Consecutive [${i}]: +3`));\n\t\t\t\t\t\tconsecutives++;\n\t\t\t\t\t\tlastChain++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tscoring.push(new Score(1, `Match [${i}]: +1`));\n\t\t\t\t\t\tupdateLongestChain();\n\t\t\t\t\t}\n\t\t\t\t\tlastMatch = i;\n\t\t\t\t\t// Add score if match is closer to the end\n\t\t\t\t\tconst endBonus = Math.clamped(Math.round((subjectParts.length - i) / 5), 0, 3);\n\t\t\t\t\tif (endBonus > 0) scoring.push(new Score(endBonus, `End bonus: +${endBonus}`));\n\t\t\t\t\t// End when there's nothing left to search\n\t\t\t\t\tsm = term[++si];\n\t\t\t\t\tif (sm === undefined) break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tupdateLongestChain();\n\n\t\t\t// Basic score for matched letters\n\t\t\tif (indexes.length > 0) scoring.push(new Score(indexes.length * 3, `Matched letters bonus: ${indexes.length * 3}`));\n\t\t\telse scoring.push(new Score(-100, 'No matches: -100'));\n\n\t\t\t// Offset less accurate matches\n\t\t\t/*\n\t\t\tscore -= subjectParts.length;\n\t\t\tscoring.push(`Accuracy penalty: -${subjectParts.length}`);\n\t\t\t*/\n\n\t\t\t// Search term found fully\n\t\t\tconst full = indexes.length == term.length;\n\t\t\tif (full) scoring.push(new Score(20, 'Full match: +20'));\n\n\t\t\t// Reduce score of search terms that are matched only partially\n\t\t\tconst half = indexes.length < Math.floor(term.length / 2) - 2;\n\t\t\tif (harsh) {\n\t\t\t\tconst cumulative = scoring.reduce((prev, cur) => cur.value + prev),\n\t\t\t\t\thalfScore = -Math.floor(cumulative / 2);\n\t\t\t\tif (half) scoring.push(new Score(halfScore, `Partial match: ${halfScore}`));\n\t\t\t\tif (longestChain <= 1) scoring.push(new Score(-20, 'Short chains: -20'));\n\t\t\t}\n\n\t\t\treturn new TermMatch({ indexes, full, half, ratio: (consecutives + 1) / term.length, consecutives, longestChain, scoring });\n\t\t}\n\n\t\tlet fullMatches0 = 0, fullMatches1 = 0;\n\n\t\t// Extremely simple search\n\t\t// TODO: Allow skipping letters in search term but impose negative score if that is the only way to get them to match.\n\t\tconst results = this.paths.reduce((results, target) => {\n\t\t\tconst matchPath = matchTerm(term, target.path),\n\t\t\t\tmatchKey = matchTerm(term, target.key);\n\n\t\t\tif (matchKey.full) fullMatches0++;\n\t\t\tif (matchPath.full) fullMatches1++;\n\n\t\t\tlet match = matchPath.ratio > 0.5,\n\t\t\t\tratio = matchPath.ratio;\n\n\t\t\tif (this._keyFocus) {\n\t\t\t\tmatchPath.score /= 5;\n\t\t\t\tratio = matchKey.ratio;\n\t\t\t\tmatch = matchKey.ratio > matchPath.ratio;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tratio += matchKey.ratio * 2;\n\t\t\t\tratio /= 3;\n\t\t\t}\n\n\t\t\tresults.push(new SearchResult({\n\t\t\t\tpath: target.path,\n\t\t\t\tmatch,\n\t\t\t\ttarget,\n\t\t\t\tkeyFocus: this._keyFocus,\n\t\t\t\tscore: matchPath.score / 2 + matchKey.score * 2,\n\t\t\t\tkeyFullMatch: matchKey.full,\n\t\t\t\tpathFullMatch: matchPath.full,\n\t\t\t\tpathIndexes: matchPath.indexes,\n\t\t\t\tkeyIndexes: matchKey.indexes,\n\t\t\t\tratio,\n\t\t\t\tscoring: { full: matchPath.scoring, key: matchKey.scoring }\n\t\t\t}));\n\n\t\t\treturn results;\n\t\t}, []);\n\n\t\tresults.sort((a, b) => {\n\t\t\tif (a.full && !b.full) return -1;\n\t\t\tif (b.full && !a.full) return 1;\n\t\t\treturn b.score - a.score;\n\t\t});\n\n\t\tvar Break = {};\n\n\t\t// Format results\n\t\ttry {\n\t\t\tresults.forEach((r, index) => {\n\t\t\t\tconst el = r.target.element;\n\t\t\t\tel.dataset.searchScore = `${r.score}`;\n\t\t\t\tel.dataset.searchRatio = `${r.ratio}`;\n\n\t\t\t\tlet q = 'decent';\n\t\t\t\tif (r.mismatch) q = 'mismatch';\n\t\t\t\telse if (r.bad) q = 'bad';\n\t\t\t\telse if (r.good) q = 'good';\n\t\t\t\tel.dataset.matchQuality = q;\n\n\t\t\t\tif (fullMatches0 > 0) {\n\t\t\t\t\tif (r.ratio > this._resultQuality) this.expandDataElTree(el);\n\t\t\t\t}\n\t\t\t\telse if (!r.bad)\n\t\t\t\t\tthis.expandDataElTree(el);\n\n\t\t\t\t// if (!r.mismatch) console.log(r.path, { score: r.score }, { r, quality: el.dataset.matchQuality });\n\n\t\t\t\t// if (index > 20) throw Break;\n\t\t\t});\n\t\t}\n\t\tcatch (err) {\n\t\t\tif (err !== Break) throw err;\n\t\t}\n\n\t\tthis.expandSelectedPath();\n\t}\n\n\t/**\n\t * @override\n\t */\n\tasync close(opts) {\n\t\t// Unregister updates\n\t\tdelete this.document.apps[this.appId];\n\t\treturn super.close(opts);\n\t}\n\n\trender(force = false, options = {}) {\n\t\tif (!options.keepCache) {\n\t\t\tthis._rollData = undefined;\n\t\t\tthis._sourceData = undefined;\n\t\t\tthis._derivedData = undefined;\n\t\t\tthis._overrides = undefined;\n\t\t\tthis._lastSearch = undefined;\n\t\t}\n\n\t\treturn super.render(force, options);\n\t}\n}\n", "import { CFG } from './core/common.mjs';\nimport { getDocData } from './core/compat.mjs';\nimport { DataInspectorDialog } from './core/dialog.mjs';\n\n/**\n * @param {Actor|Item} document\n */\nfunction openInspector(doc) {\n\tconst oldApp = Object.values(doc.apps).find(app => app.document === doc && app instanceof DataInspectorDialog);\n\tif (oldApp) {\n\t\toldApp.maximize();\n\t\toldApp.bringToTop();\n\t}\n\telse new DataInspectorDialog(doc).render(true);\n}\n\nfunction injectDataButton(sheet, buttons) {\n\tbuttons.unshift({\n\t\tclass: 'data-inspector',\n\t\ticon: 'fas fa-atom',\n\t\tlabel: game.i18n.localize('Koboldworks.DataInspector.DataButton'),\n\t\tonclick: _ => openInspector(sheet.document),\n\t});\n}\n\nclass HandlebarsHelpers {\n\tstatic listExt(obj) {\n\t\tconst rvg = [], rvf = [];\n\n\t\tconst ignored = ['constructor', 'toString'];\n\n\t\tlet proto = obj;\n\t\tdo {\n\t\t\tif (proto.constructor.name === 'Object') break;\n\t\t\tconst names = Object.getOwnPropertyNames(proto);\n\t\t\tfor (const name of names) {\n\t\t\t\tif (ignored.includes(name)) continue;\n\t\t\t\tconst desc = Object.getOwnPropertyDescriptor(proto, name);\n\t\t\t\tif (!desc) continue;\n\n\t\t\t\tif (desc.get !== undefined)\n\t\t\t\t\trvg.push({ name, type: 'getter' });\n\t\t\t\telse if (typeof desc.value === 'function')\n\t\t\t\t\trvf.push({ name, type: 'function' });\n\t\t\t}\n\n\t\t\tproto = Object.getPrototypeOf(proto);\n\t\t}\n\t\twhile (proto);\n\n\t\treturn [...rvg, ...rvf];\n\t}\n}\n\nHooks.once('ready', async () => {\n\tconst excludeRgx = new RegExp(`/modules/${CFG.module}/`);\n\t// CONFIG.compatibility.excludePatterns.push(excludeRgx);\n\n\tconst allowUsers = game.settings.get(CFG.module, CFG.SETTINGS.allowUsers);\n\tif (!allowUsers && !game.user.isGM) return;\n\n\tconst templates = ['object', 'inspector', 'value', 'object-data'];\n\n\tHooks.on('getActorSheetHeaderButtons', injectDataButton);\n\tHooks.on('getItemSheetHeaderButtons', injectDataButton);\n\n\tHandlebars.registerHelper('koboldworks-di-objext', HandlebarsHelpers.listExt);\n\n\tawait loadTemplates(templates.map(t => `modules/${CFG.module}/template/${t}.hbs`));\n\n\tconst mod = game.modules.get(CFG.module);\n\n\tmod.api = {\n\t\tinspect: openInspector,\n\t};\n\n\t// Fetch in-built system specific extensions\n\tconst systemExtPath = `modules/${CFG.module}/systems/${game.system.id}.mjs`;\n\tconst C = CFG.COLORS;\n\tfetch(systemExtPath, { method: 'HEAD', cache: 'no-cache', redirect: 'manual' })\n\t\t.then(function (response) {\n\t\t\tif (response.status !== 200 || !response.ok) {\n\t\t\t\tconsole.log('%cDATA INSPECTOR%c \uD83D\uDD0D | System specific extensions not found.', C.main, C.unset)\n\t\t\t\treturn;\n\t\t\t}\n\t\t\timport(`./systems/${game.system.id}.mjs`)\n\t\t\t\t.then(_ => console.log('%cDATA INSPECTOR%c \uD83D\uDD0D | System specific extensions loaded.', C.main, C.unset));\n\t\t});\n\n\tconst md = getDocData(mod);\n\tconsole.log(`%cDATA INSPECTOR%c \uD83D\uDD0D | %c${md.version}%c | READY`, C.main, C.unset, C.id, C.unset);\n});\n"],
  "mappings": "kjBAAO,GAAM,GAAM,CAClB,OAAQ,iBACR,SAAU,CACT,aAAc,eACd,wBAAyB,0BACzB,WAAY,aACZ,UAAW,YACX,QAAS,UACT,KAAM,MACP,EACA,OAAQ,CACP,KAAM,oBACN,OAAQ,qBACR,MAAO,uBACP,GAAI,qBACJ,MAAO,aACR,CACD,EAEA,kBAAsC,EAAM,CAC3C,GAAI,OAAO,gBACV,MAAO,WAAU,UAAU,UAAU,CAAI,EAEzC,GAAG,aAAa,KAAK,yEAAyE,CAChG,CALsB,wBAOf,GAAM,GAAa,CACzB,UAAW,GACX,KAAM,EACN,OAAQ,IACR,OAAQ,IACR,QAAS,IACT,OAAQ,IACR,MAAO,IACP,IAAK,IACL,SAAU,IACV,OAAQ,IACR,OAAQ,IACR,KAAM,KACN,SAAU,IACX,EAEa,EAAqB,aAAa,CAAU,EAMlD,YAAqB,EAAO,CAClC,GAAI,IAAU,OAAW,MAAO,YAChC,GAAI,IAAU,KAAM,MAAO,OAC3B,GAAM,GAAO,MAAO,GACpB,GAAI,CAAC,SAAU,SAAU,WAAY,SAAS,EAAE,SAAS,CAAI,EAAG,MAAO,GACvE,GAAI,MAAM,QAAQ,CAAK,EAAG,MAAO,QAEjC,GAAM,GAAI,EAAM,UAAU,YAAY,KACtC,MAAI,KAAM,SAAiB,SACvB,IAAM,MAAc,MACjB,IAAM,CACd,CAXgB,oBAaT,WAAmB,EAAO,CAChC,GAAI,IAAU,OAAW,MAAO,GAAW,UAC3C,GAAI,IAAU,KAAM,MAAO,GAAW,KAEtC,OADa,MAAO,QAEd,SACJ,MAAO,GAAW,WACd,SACJ,MAAO,GAAW,WACd,WACJ,MAAO,GAAW,aACd,UACJ,MAAO,GAAW,QAEpB,GAAI,MAAM,QAAQ,CAAK,EAAG,MAAO,GAAW,MAC5C,GAAI,YAAiB,SAAQ,SAAS,aAAc,MAAO,GAAW,KACtE,GAAI,YAAiB,SAAQ,SAAS,SAAU,MAAO,GAAW,SAElE,GAAM,GAAI,EAAM,UAAU,YAAY,KACtC,MAAI,KAAM,SAAiB,EAAW,OAClC,IAAM,MAAc,EAAW,IAC5B,EAAW,MACnB,CAtBgB,iBAwBhB,MAAM,KAAK,OAAQ,YAA4B,CAC9C,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,KAAM,CACrD,KAAM,iDACN,KAAM,qDACN,MAAO,SACP,OAAQ,GACR,KAAM,OACN,QAAS,WACT,QAAS,CACR,SAAU,sCACV,OAAQ,wCACR,QAAS,wCACV,CACD,CAAC,EAED,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,QAAS,CACxD,KAAM,mDACN,KAAM,uDACN,MAAO,SACP,OAAQ,GACR,KAAM,OACN,QAAS,GACT,MAAO,CAAE,IAAK,EAAK,IAAK,EAAK,KAAM,GAAK,CACzC,CAAC,EAED,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,UAAW,CAC1D,KAAM,sDACN,KAAM,0DACN,MAAO,SACP,OAAQ,GACR,KAAM,QACN,QAAS,EACV,CAAC,EAED,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,aAAc,CAC7D,KAAM,kDACN,KAAM,sDACN,OAAQ,GACR,MAAO,QACP,KAAM,QACN,QAAS,EACV,CAAC,EAED,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,wBAAyB,CACxE,KAAM,6DACN,KAAM,iEACN,OAAQ,GACR,MAAO,QACP,KAAM,QACN,QAAS,EACV,CAAC,EAED,KAAK,SAAS,SAAS,EAAI,OAAQ,EAAI,SAAS,WAAY,CAC3D,KAAM,gDACN,KAAM,oDACN,OAAQ,GACR,MAAO,QACP,KAAM,QACN,QAAS,EACV,CAAC,CACF,EA5DmB,mBA4DlB,ECjJM,GAAM,GAAa,EAAC,GAAQ,KAAK,QAAQ,YAAc,GAAK,EAAM,GAAK,KAApD,cACb,GAAU,EAAC,GAAQ,KAAK,QAAQ,YAAc,GAAK,QAAQ,MAAM,QAAQ,CAAG,EAAI,QAAQ,MAAM,cAAc,CAAG,EAArG,WACV,EAAe,MAAM,KAAK,QAAQ,YAAc,GAAK,SAAW,OAAjD,gBCArB,GAAM,GAAN,aAA0B,gBAAgB,CAChD,MACA,MAEA,SAGA,UAEA,UAAW,iBAAiB,CAAE,MAAO,CAAC,EAAW,OAAQ,EAAW,OAAQ,EAAW,QAAS,EAAW,KAAM,EAAW,SAAS,CAAG,CAExI,YAAY,EAAU,EAAM,EAAM,CAAE,UAAU,GAAO,OAAQ,CAAC,EAAG,CAChE,GAAM,GAAQ,CAAC,gBAAgB,EAC/B,EAAM,KAAK,EAAS,IAAI,EACxB,EAAM,KAAK,CAAI,EACf,GAAM,GAAU,CAAC,EACjB,EAAQ,MAAQ,EAAM,KAAK,IAAI,EAC/B,EAAQ,GAAK,sBAAwB,EAAS,KAAO,IAAM,EAE3D,MAAM,OAAW,CAAO,EAExB,KAAK,UAAY,EACjB,KAAK,QAAU,EACf,KAAK,MAAQ,EAEb,KAAK,SAAW,EAChB,GAAM,GAAQ,YAAY,EAAS,SAAS,EAAG,CAAI,EACnD,KAAK,eAAiB,GAAQ,EAAU,CAAK,EAC7C,KAAK,iBAAmB,EAAmB,KAAK,gBAChD,KAAK,MAAQ,KAAK,gBAGnB,CAEA,GAAI,WAAW,CACd,MAAO,WAAW,EAAI,4BACvB,CAEA,UAAW,iBAAiB,CAC3B,GAAM,GAAW,MAAM,eACvB,MAAO,aAAY,EAAU,CAC5B,GAAG,EACH,MAAO,+BACP,QAAS,CAAC,GAAG,EAAS,QAAS,cAAe,uBAAuB,EACrE,eAAgB,GAChB,cAAe,GACf,cAAe,GACf,UAAW,GACX,MAAO,IACP,OAAQ,GACT,CAAC,CACF,CAEA,SAAU,CAET,GAAM,GAAO,MAAM,QAAQ,EAErB,EAAM,KAAK,SAChB,EAAQ,YAAY,EAAI,SAAS,EAAG,KAAK,KAAK,EAC9C,EAAS,KAAK,QAAU,EAAU,CAAK,EACvC,EAAW,KAAK,OAAS,GAAY,CAAK,EAC1C,EAAmB,KAAK,iBAEzB,SAAK,SAAW,EAChB,EAAK,KAAO,KAAK,MACjB,EAAK,MAAQ,EACb,EAAK,KAAO,EACZ,EAAK,SAAW,EAChB,EAAK,aAAe,EACpB,EAAK,YAAc,IAAqB,UAAY,CAAC,OAAQ,MAAM,EAAE,SAAS,CAAQ,EACtF,EAAK,OAAS,IAAa,QAAU,IAAqB,UAAY,EAAM,KAAO,IACnF,EAAK,aAAe,IAAa,QAAU,IAAa,QAAU,IAAqB,UAAa,GAAK,MAAM,OAAS,IAAM,EAAK,MAAM,QAAQ;AAAA,CAAI,GAAK,GAC1J,EAAK,cAAgB,CAAC,EAAY,eAAe,SAAS,CAAM,EAChE,EAAK,QAAU,YAAe,OAC9B,EAAK,OAAS,YAAe,MAG7B,EAAK,WAAa,CAAC,SAAU,SAAU,SAAS,EAAE,SAAS,CAAQ,EACnE,EAAK,SAAW,CAAC,OAAQ,WAAW,EAAE,SAAS,CAAQ,EACvD,EAAK,aAAe,KAAK,MACzB,EAAK,MAAQ,CACZ,OAAQ,SACR,QAAS,UACT,OAAQ,SACR,KAAM,OACN,UAAW,YACX,KAAM,aACN,KAAM,gBACP,EAEA,EAAK,QAAU,KAAK,QAEpB,EAAK,MAAQ,EACN,CACR,CAKA,kBAAkB,EAAI,CACrB,MAAM,kBAAkB,CAAE,EAC1B,GAAM,GAAO,EAAG,GACV,EAAM,KAEN,EAAY,KAAK,UAEjB,EAAU,KAAK,QAErB,EAAK,cAAc,qBAAqB,GAAG,iBAAiB,SAAU,AAAC,GAAO,CAC7E,EAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,GAAM,GAAU,KAAK,MACpB,EAAU,EAAG,OAAO,MACrB,KAAK,MAAQ,EAEb,KAAK,OAAO,CACb,CAAC,EAGD,GAAM,GAAa,EAAK,cAAc,gBAAgB,EACtD,AAAI,GAAY,GAAW,MAAM,OAAS,QAG1C,EAAK,cAAc,qBAAqB,GACrC,iBAAiB,SAAU,SAAU,EAAI,CAC1C,EAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,EAAI,MAAQ,KAAK,MACjB,EAAI,OAAO,EAAI,CAChB,CAAC,EAEF,GAAM,GAAM,KAAK,SAChB,EAAO,KAAK,MAGb,EAAK,cAAc,eAAe,GAC/B,iBAAiB,QAAS,GAAM,CACjC,EAAG,eAAe,EAClB,EAAG,gBAAgB,EAGnB,GAAM,GAAa,CAAE,CADV,EAAK,QAAQ,WAAY,AAAC,GAAM,KAAK,GAAG,GACxB,IAAK,EAChC,QAAQ,IAAI,UAAW,CAAU,EAEjC,OAAO,QAAQ,CACd,MAAO,eACP,QAAS,oBAAoB,eAC7B,IAAK,SAAY,CAChB,GAAM,GAAM,KAAK,QAAQ,YAAc,GACvC,AAAI,CAAC,GAAO,GAAS,GAAI,MAAM,OAAS,MAExC,GAAM,GAAM,MAAM,CACjB,EAAI,MAAM,EAGN,CAAC,GAAO,GACX,EAAU,YAAY,EAAI,MAAM,KAAK,CACvC,EANY,OAOZ,EAAI,OAAO,CAAU,EACnB,KAAK,GAAK,EAAI,CAAC,EACf,MAAM,GAAK,EAAI,CAAC,CACnB,EACA,WAAY,EACb,CAAC,CACF,CAAC,CACH,CAEA,cAAc,EAAO,EAAU,CAE9B,GAAM,GAAO,KAAK,MACjB,EAAO,KAAK,MACZ,EAAM,KAAK,SACR,EAAQ,EAAS,MACrB,AAAI,IAAS,YAAa,EAAQ,OACzB,IAAS,QAAQ,GAAQ,MAElC,QAAQ,IAAI,gBAAiB,EAAM,EAAM,CAAK,EAE9C,GAAM,GAAa,CAAE,CAAC,GAAO,CAAM,EAGnC,EAAI,OAAO,CAAU,EAAE,KAAK,GAAK,KAAK,MAAM,CAAC,CAG9C,CAKA,KAAM,OAAM,EAAM,CAGjB,MAAO,OAAM,MAAM,CAAI,CACxB,CACD,EAlMa,mBCCb,GAAM,IAAgB,GAAC,EAAG,IAAM,EAAE,IAAI,cAAc,EAAE,GAAG,EAAnC,iBAEhB,EAAN,KAAmB,CAClB,IACA,KACA,YAAY,EAAK,EAAM,CACtB,KAAK,IAAM,EACX,KAAK,KAAO,CACb,CACD,EAPM,oBALN,cAca,EAAN,KAAoB,CAsN1B,YAAY,CAAE,MAAK,OAAM,QAAO,SAAQ,OAAM,WAAU,SAAS,CApNjE,cAEA,eAGA,eAEA,iBAGA,eAGA,gBAGA,iBAEA,kBAAW,CAAC,GAEZ,eAAQ,GAER,mBAOA,sBAEA,uBAEA,oBAEA,oBAoFA,iBAyBA,iBAmBA,iBAmBA,iBA2CA,iBAZC,KAAK,IAAM,EACX,KAAK,KAAO,EACZ,KAAK,OAAS,GAAQ,EAAU,CAAK,EACrC,KAAK,KAAO,EAAmB,KAAK,QACpC,KAAK,MAAQ,EACb,KAAK,OAAS,EACd,KAAK,KAAO,GAAQ,MAAQ,EAC5B,KAAK,MAAQ,EACb,KAAK,SAAW,CAEjB,CAvMA,GAAI,aAAa,CAChB,MAAO,MAAK,KAAK,WAAa,UAC/B,CAeA,GAAI,cAAc,CAAE,MAAO,MAAK,SAAW,EAAW,QAAU,KAAK,OAAO,OAAS,EAAI,CAGzF,GAAI,SAAS,CAAE,MAAO,MAAK,SAAW,EAAW,IAAM,CAGvD,GAAI,aAAa,CAAE,MAAO,MAAK,SAAW,EAAW,QAAU,CAG/D,GAAI,WAAW,CAAE,MAAO,MAAK,SAAW,EAAW,MAAQ,CAG3D,GAAI,cAAc,CAAE,MAAO,MAAK,SAAW,EAAW,SAAW,CAGjE,GAAI,YAAY,CAGf,MAFI,IAAC,EAAW,KAAM,EAAW,SAAS,EAAE,SAAS,KAAK,MAAM,GAC5D,KAAK,SAAW,KAAK,MAAM,SAAW,GACtC,KAAK,OAAS,KAAK,MAAM,MAAQ,EAEtC,CAGA,GAAI,UAAU,CAAE,MAAO,MAAK,SAAW,EAAW,KAAO,CAEzD,GAAI,QAAQ,CAAE,MAAO,MAAK,SAAW,EAAW,GAAK,CAGrD,GAAI,WAAW,CAAE,MAAO,MAAK,SAAW,EAAW,MAAQ,CAG3D,GAAI,aAAa,CAAE,MAAO,CAAC,EAAW,SAAU,EAAW,IAAI,EAAE,SAAS,KAAK,MAAM,CAAG,CAExF,GAAI,aAAa,CAChB,GAAI,KAAK,SAAW,EAAW,KAAM,MAAO,MAAK,MAAM,IACvD,GAAI,KAAK,SAAW,EAAW,SAAU,MAAO,MAAK,MAAM,EAE5D,CAGA,GAAI,YAAY,CAAE,MAAO,MAAK,MAAM,UAAU,YAAY,IAAM,CAGhE,GAAI,UAAU,CACb,MAAI,MAAK,UAAkB,GACvB,KAAK,SAAW,EAAW,MAAc,KAAK,MAAM,QAAU,EAC9D,KAAK,SAAW,EAAW,OAAe,GAAQ,KAAK,KAAK,EAC5D,KAAK,SAAW,EAAW,IAAY,KAAK,MAAM,OAAS,EAC3D,KAAK,SAAW,EAAW,OAAgB,KAAK,SAAS,QAAU,EAChE,EACR,CAGA,GAAI,WAAW,CAAE,MAAO,MAAK,SAAW,EAAW,MAAQ,CAG3D,GAAI,WAAW,CAAE,MAAO,MAAK,SAAW,EAAW,MAAQ,CAG3D,GAAI,UAAU,CAAE,MAAO,MAAK,QAAQ,SAAW,EAAO,CAGtD,GAAI,cAAc,CAAE,MAAO,CAAC,EAAW,MAAO,EAAW,OAAQ,EAAW,IAAK,EAAW,MAAM,EAAE,SAAS,KAAK,MAAM,CAAG,CAG3H,GAAI,WAAW,CAAE,MAAO,MAAK,SAAW,EAAW,MAAQ,CAG3D,GAAI,iBAAiB,CACpB,MAAI,MAAK,SAAW,EAAW,UAAkB,YAC7C,KAAK,SAAW,EAAW,KAAa,OACxC,KAAK,SAAW,EAAW,SAEvB,WAED,KAAK,KACb,CAIA,GAAI,aAAa,CAChB,GAAI,OAAK,KAAY,OAAW,CAC/B,GAAI,KAAK,KAAK,WAAa,WAAY,MAAO,QAAK,EAAU,IAC7D,GAAI,CAAC,KAAK,KAAK,UAAW,MAAO,GACjC,GAAI,CACH,MAAO,QAAK,EAAU,YAAY,KAAK,KAAK,UAAW,KAAK,IAAI,EACjE,MACA,CAEA,CACA,MAAO,QAAK,EAAU,EACvB,CACA,MAAO,QAAK,EACb,CAEA,qBAAqB,EAAM,CAC1B,MAAI,MAAK,WAED,GADQ,EAAa,KACR,IAET,CACb,CAIA,GAAI,eAAe,CAClB,GAAI,OAAK,KAAc,OAAW,CACjC,GAAI,KAAK,KAAK,WAAa,SAAU,MAAO,QAAK,EAAY,IAC7D,GAAI,CAAC,KAAK,KAAK,YAAa,MAAO,GACnC,GAAM,GAAO,KAAK,qBAAqB,KAAK,IAAI,EAChD,GAAI,CACH,GAAM,GAAO,KAAK,KAAK,YACvB,MAAO,QAAK,EAAY,YAAY,EAAM,CAAI,EAC/C,MACA,CAEA,CACA,MAAO,QAAK,EAAY,EACzB,CACA,MAAO,QAAK,EACb,CAIA,GAAI,gBAAgB,CACnB,GAAI,OAAK,KAAe,OAAW,CAClC,GAAI,KAAK,KAAK,WAAa,UAAW,MAAO,QAAK,EAAa,IAC/D,GAAI,CAAC,KAAK,KAAK,aAAc,MAAO,GACpC,GAAM,GAAO,KAAK,qBAAqB,KAAK,IAAI,EAChD,GAAI,CACH,GAAM,GAAO,KAAK,KAAK,aACvB,MAAO,QAAK,EAAa,YAAY,EAAM,CAAI,EAChD,MACA,CAEA,CACA,MAAO,QAAK,EAAa,EAC1B,CACA,MAAO,QAAK,EACb,CAGA,GAAI,kBAAkB,CACrB,GAAI,OAAK,KAAiB,OAAW,CACpC,GAAI,CAAC,KAAK,KAAK,eAAgB,MAAO,GACtC,GAAM,GAAO,KAAK,qBAAqB,KAAK,IAAI,EAChD,GAAI,CACH,GAAM,GAAO,KAAK,KAAK,eACvB,MAAO,QAAK,EAAe,YAAY,EAAM,CAAI,EAClD,MACA,CAEA,CACA,MAAO,QAAK,EAAe,EAC5B,CACA,MAAO,QAAK,EACb,CAEA,GAAI,eAAe,CAClB,MAAO,CAAC,CAAC,KAAK,UACf,CAGA,GAAI,MAAM,CACT,MAAI,MAAK,SAAW,EAAW,QACvB,KAAK,MAAQ,OAAS,QAC1B,KAAK,SAAW,EAAW,OACvB,KAAK,QAAU,EAAI,OAAS,KAAK,MAAQ,EAAI,WAAa,WAC3D,EACR,CAiBA,WAAY,CACX,GAAI,OAAK,GAAY,MAAO,QAAK,GACjC,GAAI,KAAK,WAAY,MAAO,CAAC,EAC7B,OAAQ,KAAK,YACP,GAAW,MAAO,MAAO,QAAK,EAAa,CAAC,KAAK,MAAM,IAAI,GAAK,GAAI,GAAa,CAAC,CAAC,CAAC,OACpF,GAAW,IAAK,MAAO,QAAK,EAAa,CAAC,MAAM,KAAK,KAAK,MAAM,KAAK,CAAC,EAAE,IAAI,GAAK,GAAI,GAAa,CAAC,CAAC,CAAC,OACrG,GAAW,WACX,GAAW,OAAQ,CACvB,GAAM,GAAU,CAAC,EAAG,EAAM,CAAC,EAAG,EAAM,CAAC,EAGrC,GAFA,EAAQ,KAAK,GAAG,OAAO,oBAAoB,KAAK,KAAK,EAAE,IAAI,GAAK,GAAI,GAAa,CAAC,CAAC,CAAC,EAEhF,EAAc,iBAAkB,CAEnC,GAAI,GAAQ,KAAK,MACX,EAAU,CAAC,cAAe,WAAY,cAAe,YAAa,YAAa,SAAS,EAC9F,EAAG,CACF,GAAI,EAAM,YAAY,OAAS,SAAU,MACzC,GAAM,GAAO,OAAO,oBAAoB,CAAK,EAC7C,OAAW,KAAO,GAAM,CACvB,GAAI,EAAQ,SAAS,CAAG,EAAG,SAC3B,GAAM,GAAO,OAAO,yBAAyB,EAAO,CAAG,EACvD,AAAI,CAAC,GAEL,CAAI,EAAK,MAAQ,OAChB,EAAI,KAAK,GAAI,GAAa,EAAK,EAAW,MAAM,CAAC,EACzC,MAAO,GAAK,OAAU,YAC9B,EAAI,KAAK,GAAI,GAAa,EAAK,EAAW,QAAQ,CAAC,EACrD,CAEA,EAAQ,OAAO,eAAe,CAAK,CACpC,OACO,EACR,CACA,MAAO,QAAK,EAAa,CAAC,EAAQ,KAAK,EAAa,EAAG,EAAI,KAAK,EAAa,EAAG,EAAI,KAAK,EAAa,CAAC,EACxG,SAEC,MAAO,QAAK,EAAa,CAAC,GAE7B,CAEA,cAAe,CACd,GAAM,GAAU,KAAK,KACpB,EAAW,GAAS,OAAS,EAAU,KAAK,IAC5C,EAAU,KAAK,QACf,EAAQ,KAAK,MAER,EAAgB,EAAC,GAAS,CAC/B,GAAM,QAAQ,CAAC,EAAQ,IAAM,CAC5B,GAAM,CAAE,MAAK,QAAS,EAChB,EAAU,AAAC,EAAgB,EAAN,EAC1B,EAAQ,EAAQ,KAAK,MAAM,IAAI,CAAO,EAAI,KAAK,MAAM,GAChD,EAAO,EAAW,GAAG,KAAY,IAAY,EAMnD,GAHI,AADO,MAAM,KAAK,4BAA6B,KAAK,KAAK,SAAU,EAAM,KAAK,QAAQ,IAC/E,IAGP,AADW,EAAU,CAAK,IACf,EAAW,UAAY,CAAC,EAAc,iBAAkB,OACvE,GAAM,GAAI,GAAI,GAAc,CAAE,IAAK,EAAS,OAAM,QAAO,OAAQ,KAAM,OAAM,MAAO,KAAK,MAAQ,CAAE,CAAC,EACpG,KAAK,SAAS,KAAK,CAAC,CACrB,CAAC,CACF,EAfsB,iBAiBhB,CAAC,EAAK,EAAW,GAAW,KAAK,UAAU,EAEjD,SAAc,CAAG,EACjB,EAAc,CAAS,EACvB,EAAc,CAAO,EAEd,KAAK,QACb,CAEA,MAAO,SAAQ,EAAY,EAAK,EAAM,EAAM,CAAE,mBAAmB,GAAO,YAAa,CAAC,EAAG,CACxF,EAAc,iBAAmB,GAAoB,GAErD,GAAM,GAAK,GAAI,GAAc,CAAE,MAAK,OAAM,MAAO,EAAY,OAAQ,KAAM,SAAU,EAAM,MAAO,CAAE,CAAC,EACrG,EAAG,SAAW,EACd,EAAG,KAAO,EACV,GAAM,GAAM,CAAC,EACb,AAAI,EAAG,MAAM,GAAI,EAAG,MAAQ,GAC5B,GAAI,GAAY,EAAG,EAAQ,GAK3B,WAAyB,EAAK,CAC7B,EAAI,aAAa,EAAE,QAAQ,GAAM,CAGhC,GAFA,EAAI,EAAG,MAAQ,EACf,IACI,EAAY,KAAO,CACtB,AAAK,GACJ,IAAG,cAAc,MAAM,iFAAiF,EACxG,QAAQ,MAAM,EAAG,KAAM;AAAA;AAAA,EAAuF,CAAE,EAChH,EAAQ,IAET,MACD,CACA,EAAgB,CAAE,CACnB,CAAC,CACF,CAdS,8BAgBT,EAAgB,CAAE,EAEX,CAAE,KAAM,EAAI,KAAI,CACxB,CAYA,UAAU,EAAM,CACf,GAAM,GAAQ,EAAK,MAAM,GAAG,EACtB,EAAM,EAAM,MAAM,EASlB,EAAI,AAPM,MAAM,CACrB,OAAQ,KAAK,YACP,GAAW,MAAO,MAAO,MAAK,SAAS,SAAS,CAAG,WAC/C,MAAO,MAAK,SAAS,KAAK,GAAM,EAAG,MAAQ,CAAG,EAEzD,EALgB,WAOE,EAElB,MAAI,GAAM,SAAW,EAAU,EACnB,GAAG,UAAU,EAAM,KAAK,GAAG,CAAC,CACzC,CACD,EAzWa,EAAN,EAAM,qBAyHZ,cAyBA,cAmBA,cAmBA,cA2CA,cA3LA,EAxCY,EAwCL,mBAAmB,ICjD3B,YAAiC,EAAK,CACrC,GAAM,GAAS,EAAa,EACtB,EAAO,CAAE,KAAM,EAAI,KAAO,eAAgB,KAAM,EAAI,KAAM,CAAC,GAAS,CAAE,CAAE,EAC9E,aAAM,KAAK,+BAAgC,EAAK,CAAI,EAC7C,YAAe,OAAQ,GAAI,OAAM,CAAI,EAAI,GAAI,MAAK,CAAI,CAC9D,CALS,gCAOT,GAAM,GAAN,KAAmB,CAElB,KAGA,SAAW,GAGX,MAGA,GAAI,WAAW,CAAE,MAAO,MAAK,QAAQ,KAAK,SAAW,CAAG,CAOxD,OAEA,MAGA,aAEA,cAEA,QAAU,CAET,KAAM,CAAC,EAEP,IAAK,CAAC,CACP,EAGA,MAEA,GAAI,OAAO,CAAE,MAAO,MAAK,MAAQ,EAAK,CAEtC,GAAI,MAAM,CAAE,MAAO,MAAK,MAAQ,EAAK,CACrC,QAAU,CAET,KAAM,OAEN,IAAK,MACN,EAEA,YAAY,CAAE,OAAM,QAAO,SAAQ,QAAO,WAAU,eAAc,gBAAe,cAAa,aAAY,QAAO,WAAY,CAAC,EAAG,CAChI,KAAK,KAAO,EACZ,KAAK,MAAQ,EACb,KAAK,OAAS,EAEd,KAAK,SAAW,EAEhB,KAAK,MAAQ,EACb,KAAK,aAAe,EACpB,KAAK,cAAgB,EACrB,KAAK,QAAQ,KAAO,EACpB,KAAK,QAAQ,IAAM,EAEnB,KAAK,MAAQ,EAEb,KAAK,QAAU,CAChB,CACD,EAhEM,oBAkEN,GAAM,IAAN,KAAgB,CAEf,MAEA,QACA,KACA,KAEA,MAEA,aAEA,aAEA,QAEA,YAAY,CAAE,UAAS,OAAM,OAAM,QAAO,eAAc,eAAc,WAAY,CAAC,EAAG,CACrF,KAAK,QAAU,EACf,KAAK,KAAO,EACZ,KAAK,KAAO,EACZ,KAAK,MAAQ,EACb,KAAK,aAAe,EACpB,KAAK,aAAe,EACpB,KAAK,QAAU,EACf,KAAK,MAAQ,EAAQ,OAAO,CAAC,EAAK,IAAQ,EAAM,EAAI,KAAK,CAC1D,CACD,EA1BM,kBA4BN,GAAM,GAAN,KAAY,CAEX,MAEA,YAMA,YAAY,EAAO,EAAa,CAC/B,KAAK,MAAQ,EACb,KAAK,YAAc,CACpB,CACD,EAdM,aAgBC,GAAM,GAAN,aAAkC,gBAAgB,CACxD,MAAQ,GAER,QACA,QAAU,GACV,WAAa,GACb,WAAa,GACb,UAAY,GACZ,MAAQ,WACR,eAAiB,GAAI,KACrB,aACA,YACA,eACA,UACA,WACA,eAAiB,GAEjB,KAEA,YAEA,MAEA,YAAY,EAAU,EAAU,CAAC,EAAG,CACnC,GAAM,GAAQ,CAAC,gBAAgB,EAE3B,EAAS,KACb,AAAI,EAAS,OAAO,GAAS,EAAS,OAElC,GAAQ,EAAM,KAAK,EAAO,IAAI,EAElC,EAAM,KAAK,EAAS,IAAI,EAExB,EAAQ,MAAQ,EAAM,KAAK,IAAI,EAC/B,EAAQ,GAAK,sBAAwB,EAAS,KAE9C,MAAM,EAAU,CAAO,EAEvB,KAAK,WAAa,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,SAAS,EACtE,KAAK,eAAiB,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,OAAO,EACxE,KAAK,MAAQ,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,IAAI,EAE5D,KAAK,SAAW,EAChB,KAAK,YAAc,EAGnB,EAAS,KAAK,KAAK,OAAS,IAC7B,CAEA,GAAI,WAAW,CAAE,MAAO,WAAW,EAAI,+BAAiC,CAExE,UAAW,iBAAiB,CAC3B,GAAM,GAAW,MAAM,eACvB,MAAO,aAAY,EAAU,CAC5B,MAAO,iBACP,QAAS,CAAC,GAAG,EAAS,QAAS,cAAe,gBAAgB,EAC9D,UAAW,GACX,MAAO,IACP,OAAQ,IACR,QAAS,CAAC,UAAU,CACrB,CAAC,CACF,CAEA,eAAe,EAAK,EAAM,CACzB,GAAM,GAAM,KAAK,QAAQ,YAAc,GACvC,OAAQ,GAAQ,KAAK,mBAEf,QACJ,MAAI,MAAK,WAAa,MAAM,MAAK,UAAY,EAAI,YAAY,GACzD,KAAK,aAAe,MAAM,MAAK,YAAc,EAAI,SAAS,GAC1D,KAAK,cAAgB,MAAM,MAAK,aAAe,EAAW,CAAG,GAC7D,KAAK,YAAc,MAAM,MAAK,WAAa,EAAM,EAAI,OAAO,UAAY,EAAI,OAAO,KAAK,WACrF,CAAC,MACJ,WACJ,MAAI,MAAK,YAAc,MAAM,MAAK,WAAa,EAAM,EAAI,OAAO,UAAY,EAAI,OAAO,KAAK,WACrF,KAAK,eACR,WACJ,MAAI,MAAK,WAAa,MAAM,MAAK,UAAY,EAAI,YAAY,GACtD,KAAK,cACR,SACJ,MAAI,MAAK,aAAe,MAAM,MAAK,YAAc,EAAI,SAAS,GACvD,KAAK,gBACR,UACJ,MAAI,MAAK,cAAgB,MAAM,MAAK,aAAe,EAAW,CAAG,GAC1D,KAAK,aAGf,CAGA,YAAY,EAAK,CAChB,KAAK,SAAW,EAChB,EAAI,KAAK,KAAK,OAAS,KACvB,KAAK,OAAO,CACb,CAEA,SAAU,CACT,GAAM,GAAO,MAAM,QAAQ,EAC1B,EAAM,KAAK,SACX,EAAU,YAAe,OACzB,EAAO,EAAI,KACX,EAAe,GAAG,EAAU,QAAU,cAAc,EAAK,WAAW,IACpE,EAAY,KAAK,KAAK,SAAS,CAAY,EAE5C,AAAI,KAAK,QAAU,UAClB,MAAK,iBAAmB,GAAwB,KAAK,QAAQ,EAAE,SAAS,GAGzE,GAAM,GAAS,EAAa,EAE5B,EAAK,SAAW,CAAE,CAAC,GAAS,KAAK,eAAe,EAAK,UAAU,CAAE,EACjE,EAAK,WAAa,KAAK,eAAe,EAAK,QAAQ,EACnD,EAAK,QAAU,KAAK,eAAe,EAAK,SAAS,EACjD,EAAK,UAAY,KAAK,eAAe,EAAK,UAAU,EAEpD,GAAM,GAAU,KAAK,eAAe,CAAG,EAEvC,EAAK,SAAW,EAEhB,EAAK,KAAO,EACZ,EAAK,UAAY,EACjB,EAAK,QAAU,EAAI,YAAY,KAC/B,EAAK,SAAW,KAAK,MACrB,EAAK,WAAa,KAAK,QAAU,WACjC,EAAK,aAAe,KAAK,QAAU,SACnC,EAAK,cAAgB,KAAK,QAAU,UACpC,EAAK,eAAiB,KAAK,QAAU,WACrC,EAAK,cAAgB,KAAK,eAC1B,GAAM,GAAa,KAAK,QAAU,WAE5B,EAAW,EAAa,KAAO,EAC/B,CAAE,OAAM,OAAQ,EAAc,QAAQ,EAAa,EAAU,EAAQ,GAAS,EAAU,EAAU,KAAK,MAAO,CAAE,iBAAkB,KAAK,WAAY,SAAU,CAAI,CAAC,EACxK,SAAK,KAAO,EACZ,KAAK,KAAO,EAEZ,EAAK,YAAc,EAAK,WACxB,EAAK,aAAe,EAAK,QACzB,EAAK,UAAY,EAAK,SACtB,EAAK,WAAa,EAAK,UACvB,EAAK,eAAiB,KAAK,eAEvB,KAAK,QAAU,YAClB,GAAK,WAAa,EAAW,EAAK,UAAU,EAC5C,EAAK,QAAU,EAAW,EAAK,OAAO,GAGvC,EAAK,KAAO,EAAI,KAChB,EAAK,OAAS,KAAK,QACnB,EAAK,UAAY,KAAK,WACtB,EAAK,iBAAmB,KAAK,WAC7B,EAAK,gBAAkB,KAAK,UAC5B,EAAK,KAAO,KAAK,MAEjB,EAAK,MAAQ,EAEN,CACR,CAOA,WAAW,EAAI,KAAa,EAAM,CACjC,EAAS,EAAI,GAAG,CAAI,EACpB,GAAM,GAAS,EAAG,cAClB,AAAI,GAAU,CAAC,KAAM,IAAI,EAAE,SAAS,EAAO,OAAO,GACjD,KAAK,WAAW,EAAQ,EAAU,GAAG,CAAI,CAC3C,CAEA,YAAY,EAAI,EAAU,GAAM,CAE/B,AAAI,KAAK,SAAS,KAAK,QAAQ,UAAU,OAAO,WAAY,EAAK,EACjE,EAAG,UAAU,OAAO,WAAY,CAAO,EACvC,KAAK,QAAU,CAChB,CAEA,iBAAiB,EAAI,CACpB,KAAK,WAAW,EAAI,KAAK,aAAc,GAAO,EAAI,CACnD,CAKA,aAAa,EAAI,EAAS,GAAM,EAAS,OAAW,CAGnD,GAFA,EAAG,UAAU,OAAO,OAAQ,EAAK,EAE7B,IAAG,UAAU,SAAS,OAAO,GAAK,EAAG,UAAU,SAAS,OAAO,GAMnE,IAAI,EAAQ,CACX,GAAM,GAAO,EAAG,QAAQ,KAClB,EAAQ,KAAK,eACnB,EAAG,UAAU,SAAS,WAAW,EAAI,EAAM,IAAI,CAAI,EAAI,EAAM,OAAO,CAAI,CACzE,CAGA,EAAG,UAAU,OAAO,YAAa,IAAW,OAAY,CAAC,EAAS,MAAS,EAC3E,EAAG,UAAU,OAAO,WAAY,CAAM,EACvC,CAKA,mBAAmB,EAAI,EAAO,GAAO,EAAgB,GAAO,CAI3D,AAHA,EAAG,UAAU,OAAO,OAAQ,CAAI,EAChC,EAAG,QAAQ,aAAe,KAC1B,EAAG,UAAU,OAAO,WAAY,EAAK,EACjC,IAAG,UAAU,SAAS,OAAO,GAAK,EAAG,UAAU,SAAS,OAAO,IACnE,GAAG,UAAU,OAAO,YAAa,EAAI,EACrC,EAAG,UAAU,OAAO,WAAY,EAAK,EACtC,CAKA,WAAW,EAAI,EAAI,CAClB,EAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,KAAK,aAAa,CAAE,CACrB,CAKA,kBAAkB,EAAI,CACrB,MAAM,kBAAkB,CAAE,EAE1B,GAAM,GAAO,EAAG,GAEV,EAAS,EAAK,cAAc,SAAS,EAErC,EAAQ,EAAK,QAAQ,cAAc,EACzC,GAAI,EAAO,CACV,GAAM,GAAM,KAAK,SACX,EAAO,YAAe,MAAO,EAAM,KACzC,AAAI,GACH,GAAM,QAAQ,OAAS,EAAK,GAC5B,EAAM,QAAQ,SAAW,EAAK,MAG/B,GAAM,GAAQ,YAAe,OAAQ,EAAM,KAAK,YAChD,AAAI,GACH,GAAM,QAAQ,QAAU,EAAM,GAC9B,EAAM,QAAQ,UAAY,EAAM,KAElC,CAEA,GAAM,GAAY,EAAO,cAAc,YAAY,EAC7C,EAAM,KACN,EAAW,KAAK,QAAU,WAC1B,EAAU,KAAK,QAAU,SAK/B,WAA0B,EAAI,CAC7B,GAAM,GAAQ,EAAG,OAAO,MACxB,GAAI,EAAI,QAAU,EAAO,CACxB,EAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,EAAG,OAAO,SAAW,GAGrB,GAAM,GAAO,EAAI,MACjB,GAAI,EAAK,OAAS,EAAG,CACpB,GAAM,GAAQ,EAAK,MAAM,EAAE,EACrB,EAAS,GAAG,EAAa,KAC/B,AAAI,EAAK,KAAO,KAAO,EAAI,QAAU,WACpC,EAAM,OAAO,EAAG,EAAG,CAAM,EACjB,EAAK,OAAS,GAAK,EAAK,WAAW,CAAM,GAAK,IAAU,YAChE,EAAM,OAAO,EAAG,EAAO,OAAQ,GAAG,EACnC,EAAI,MAAQ,EAAM,KAAK,EAAE,CAC1B,CAGA,EAAI,MAAQ,EAAI,YAAY,EAAI,MAAO,EAAI,KAAK,EAChD,EAAI,MAAQ,EACZ,EAAI,YAAc,OAClB,EAAI,OAAO,GAAO,CAAE,UAAW,EAAK,CAAC,CACtC,CACD,CAzBS,wBA2BT,EAAO,cAAc,aAAa,EAAE,iBAAiB,SAAU,CAAgB,EAE/E,WAA6B,EAAI,CAEhC,EAAI,eAAiB,OAAO,KAAK,KAAK,EAClC,EAAI,QAAQ,OAAS,GAAG,EAAI,SAAS,EAAI,QAAS,CAAE,aAAc,EAAK,CAAC,CAC7E,CAJS,2BAMT,EAAO,cAAc,sBAAsB,EAAE,iBAAiB,SAAU,CAAmB,EAE3F,WAAkB,EAAI,CACrB,EAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,GAAM,GAAK,KACL,EAAO,EAAG,QAAQ,KAClB,EAAa,EAAW,IAAI,IAAS,EAI3C,GAHA,EAAU,MAAQ,EAClB,EAAI,MAAQ,EACZ,EAAI,YAAY,EAAI,EAAI,EACpB,OAAO,gBACV,MAAO,IAAgB,CAAU,CACnC,CAXS,gBAaT,EAAG,GAAG,QAAS,cAAe,SAAU,EAAI,CAAE,EAAI,WAAW,EAAI,IAAI,CAAG,CAAC,EACzE,EAAG,GAAG,cAAe,cAAe,CAAQ,EAC5C,EAAU,iBAAiB,QAAS,GAAM,KAAK,mBAAmB,EAAG,OAAO,MAAO,EAAI,EAAI,CAAC,EAC5F,EAAU,iBAAiB,SAAU,GAAM,KAAK,mBAAmB,EAAG,OAAO,MAAO,EAAI,EAAK,CAAC,EAG9F,EAAK,iBAAiB,aAAa,EAAE,QAAQ,GAAM,CAClD,GAAM,GAAO,EAAG,QAAQ,KACxB,AAAI,KAAK,eAAe,IAAI,CAAI,GAC/B,KAAK,aAAa,CAAE,CACtB,CAAC,EAQD,GAAM,GAAc,EAAK,cAAc,cAAc,EACrD,EAAY,iBAAiB,WAAY,WAAoB,EAAI,CAIhE,GAHA,EAAG,eAAe,EAClB,EAAG,gBAAgB,EAEf,CAAC,SAAU,UAAU,EAAE,SAAS,EAAI,KAAK,EAAG,CAC/C,GAAM,GAAK,EAAG,OACR,EAAM,EAAG,QAAQ,KAAO,EAAK,EAAG,QAAQ,aAAa,EAC3D,AAAI,GAAK,EAAI,iBAAiB,EAAI,EAAI,QAAQ,IAAI,CACnD,KAEC,IAAG,cAAc,KAAK,6BAA6B,EAAI,cAAc,CAEvE,EAZyC,aAYxC,EAQD,GAAM,GAAmB,EAAC,GAAO,CAChC,GAAM,GAAO,EAAG,QAAQ,KAClB,EAAM,EAAG,QAAQ,IACjB,EAAQ,EAAG,cAAc,IAAI,EACnC,KAAK,MAAM,IAAI,EAAM,CACpB,OACA,MACA,QAAS,EACT,MAAO,EAAM,WACd,CAAC,CACF,EAVyB,oBAYzB,WAA2B,EAAI,EAAI,CAClC,GAAM,GAAI,EAAG,sBAAsB,EACnC,EAAG,MAAM,SAAW,SAAS,EAAE,kBAAkB,EAAG,wBAAwB,EAAE,iBAAiB,EAAG,2BAA2B,EAAE,oBAAoB,EAAE,mBAAmB,EAAE,iBAAiB,EAAE,MAC9L,CAHS,yBAKT,GAAM,GAAQ,EAAY,iBAAiB,eAAe,EACpD,EAAa,KAAK,QAAU,WAAa,IAAM,GACrD,EAAM,QAAQ,GAAM,CACnB,GAAM,GAAM,EAAG,cAAc,UAAU,EACvC,EAAI,iBAAiB,aAAc,GAAM,CAGxC,GAAM,GAAK,SAAS,cAAc,MAAM,EACxC,EAAG,UAAU,IAAI,SAAS,EAC1B,EAAI,UAAU,IAAI,aAAa,EAC/B,GAAM,GAAO,EAAG,QAAQ,KAClB,EAAQ,EAAa,EAEvB,EAAQ,EACZ,GAAI,EAAI,QAAU,WAAY,CAC7B,GAAM,GAAQ,EAAK,MAAM,GAAG,EAC5B,EAAM,MAAM,EACZ,EAAQ,EAAM,KAAK,GAAG,CACvB,CAEA,GAAM,GAAI,KAAK,MAAM,UAAU,CAAK,EAC9B,EAAS,EAAE,OACX,GAAW,IAAW,EAAW,OAAS,EAAmB,GAAU,IAAI,EAAE,aAG7E,EAAY,CACjB,2CACA,EACA,cACA,2CACA,GACA,aACD,EAEA,AAAI,CAAC,EAAW,KAAM,EAAW,QAAQ,EAAE,SAAS,CAAM,GACzD,EAAU,KACT,kDACA,EAAE,WACF,aACD,EAGD,EAAU,KAAK,MAAM,EAErB,GAAM,GAAS,CAAC,EAChB,AAAI,EAAE,KAAK,WAAa,YAAY,EAAO,KAAK,CAAE,MAAO,YAAa,QAAS,EAAE,UAAW,CAAC,EACzF,EAAE,KAAK,WAAa,WAAW,EAAO,KAAK,CAAE,MAAO,UAAW,QAAS,EAAE,aAAc,CAAC,EAC7F,AAAI,EAAE,KAAK,WAAa,SACvB,EAAO,KAAK,CAAE,MAAO,SAAU,QAAS,EAAE,YAAa,CAAC,EAExD,EAAO,KAAK,CAAE,MAAO,YAAa,QAAS,EAAE,eAAgB,CAAC,EAE/D,EAAU,KAAK,uBAAuB,EACtC,OAAW,KAAK,GACf,EAAU,KAAK,4BAA6B,yBAA0B,EAAE,MAAO,WAAY,uBAAwB,EAAE,QAAU,SAAM,SAAK,UAAW,QAAQ,EAE9J,EAAU,KAAK,QAAQ,EAEvB,EAAG,UAAY,EAAU,KAAK,EAAE,EAEhC,EAAI,QAAQ,CAAE,EAEd,EAAkB,EAAI,CAAE,EAGxB,EAAG,iBAAiB,aAAc,IAAM,EAAkB,EAAI,CAAE,EAAG,CAAE,QAAS,EAAK,CAAC,CACrF,EAAG,CAAE,QAAS,GAAM,KAAM,EAAK,CAAC,CACjC,CAAC,EAED,GAAM,GAAS,EAAO,cAAc,cAAc,EAClD,EAAO,iBAAiB,SAAU,GAAM,KAAK,eAAe,EAAG,OAAO,MAAO,EAAI,EAAK,EAAG,CAAE,QAAS,EAAK,CAAC,EAC1G,EAAO,iBAAiB,QAAS,GAAM,KAAK,eAAe,EAAG,OAAO,MAAO,EAAI,EAAI,EAAG,CAAE,QAAS,EAAK,CAAC,EAExG,KAAK,MAAQ,GAAI,YACjB,EAAM,QAAQ,GAAM,EAAiB,CAAE,CAAC,EAWxC,AADkB,EAAO,cAAc,iBAAiB,EAC9C,iBAAiB,SAAU,GAAM,CAC1C,EAAG,eAAe,EAClB,EAAG,gBAAgB,EAEnB,KAAK,WAAa,EAAG,OAAO,QAC5B,KAAK,OAAO,CACb,CAAC,EAUG,KAAK,QAAQ,QAAQ,KAAK,eAAe,KAAK,OAAO,EAErD,KAAK,YACH,MAAK,sBAAsB,MAAK,qBAAuB,KAAK,gBAAgB,KAAK,IAAI,GAC1F,EAAY,iBAAiB,QAAS,SAAU,EAAI,CACnD,AAAI,CAAC,EAAG,OAAO,QAAQ,eAAe,GACtC,GAAG,eAAe,EAClB,EAAG,gBAAgB,EACnB,EAAI,qBAAqB,CAAE,EAC5B,CAAC,GAIF,KAAK,mBAAmB,CACzB,CAMA,iBAAiB,EAAO,EAAM,CAC7B,GAAI,CAAC,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,YAAY,EAC3D,MAAO,IAAG,cAAc,KAAK,4BAA4B,EAE1D,GAAM,GAAK,EAAK,MAAM,GAAG,EAErB,EADY,EAAW,KAAK,QAAQ,EAGxC,KAAO,EAAG,OAAS,GAAG,CACrB,GAAM,GAAO,EAAG,MAAM,EAEtB,GADA,EAAc,EAAY,GACtB,GAAe,MAAQ,EAAG,OAAS,EACtC,MAAO,IAAG,cAAc,KAAK,8CAA8C,GAAM,EAClF,GAAI,MAAM,QAAQ,CAAW,GAAK,EAAG,OAAS,EAC7C,MAAO,IAAG,cAAc,KAAK,4DAA4D,GAAM,CACjG,CAEA,GAAM,GAAO,EAAU,CAAW,EAC5B,EAAc,EAAY,eAAe,SAAS,CAAI,EAC5D,GAAI,CAAC,EAAY,eAAe,SAAS,CAAI,GAExC,CADqB,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,uBAAuB,EAE1F,MAAO,IAAG,cAAc,KAAK,iCAAiC,EAAmB,IAAO,EAK1F,GAAI,GAAY,KAAK,SAAU,EAAM,EAAM,CAAE,QAAS,KAAK,QAAU,WAAY,IAAK,IAAK,CAAC,EAAE,OAAO,GAAM,CAAE,MAAO,EAAK,CAAC,CAC3H,CAEA,QAAQ,EAAQ,CACf,GAAM,GAAK,KAAK,QAAQ,GACxB,eAAQ,IAAI,cAAe,CAAE,EACtB,GAAgB,CAAE,CAC1B,CAEA,qBAKA,gBAAgB,EAAO,CACtB,EAAM,yBAAyB,EAC/B,EAAM,eAAe,EACrB,GAAM,GAAS,EAAM,OACrB,AAAI,CAAC,GACL,GAAO,oBAAoB,QAAS,KAAK,oBAAoB,EAC7D,KAAK,eAAe,CAAM,EAC3B,CAKA,eAAe,EAAS,CACvB,GAAM,GAAK,EAAQ,QAAQ,KAAO,EAAU,EAAQ,QAAQ,aAAa,EACzE,GAAI,CAAC,EAAI,OAKT,GAAI,GAAa,AAHJ,EAAG,QAAQ,KAGF,MAAM,GAAG,EAC/B,EAAW,MAAM,EACjB,EAAa,EAAW,KAAK,GAAG,EAEhC,GAAM,GAAK,KAAK,KAAK,UAAU,CAAU,EACnC,EAAQ,EAAG,MAEjB,EAAQ,YAAc,EACtB,EAAQ,UAAU,IAAI,UAAU,EAChC,GAAM,GAAO,EAAU,CAAK,EACtB,EAAI,GAAI,GAAc,CAAE,IAAK,EAAG,IAAK,KAAM,EAAG,KAAM,QAAO,MAAK,CAAC,EACvE,EAAQ,UAAU,IAAI,EAAE,IAAI,CAE7B,CAMA,YAAY,EAAM,EAAM,CAEvB,OADA,IAAS,KAAK,MACN,OACF,WACJ,MAAO,GAAK,QAAQ,KAAM,EAAE,UAE5B,MAAO,GAAK,UAAU,EAAa,MAAM,EAE5C,CAEA,oBAAqB,CACpB,GAAI,KAAK,MAAM,QAAU,EAAG,OAE5B,GAAM,GAAO,KAAK,YAAY,KAAK,KAAK,EAGlC,EAAI,KAAK,MAAM,IAAI,CAAI,EAC7B,AAAI,GACH,MAAK,iBAAiB,EAAE,OAAO,EAC/B,KAAK,QAAU,EAAE,QACjB,KAAK,YAAY,KAAK,QAAS,EAAI,EACnC,KAAK,QAAQ,eAAe,CAAE,MAAO,QAAS,CAAC,EAEjD,CAEA,mBAAqB,IACrB,iBACA,iBAOA,eAAe,EAAQ,EAAO,EAAS,GAAO,CAC7C,aAAa,KAAK,gBAAgB,EAE9B,EAAO,SAAW,GAAG,GAAS,IAClC,GAAM,GAAQ,KAAK,QAAQ,EAAS,EAAO,OAAS,EAAI,KAAK,mBAAqB,KAAK,mBAAqB,EAAI,KAAK,mBAAqB,EAAG,IAAK,GAAG,EACrJ,KAAK,iBAAmB,WAAW,GAAK,KAAK,SAAS,CAAM,EAAG,CAAK,CACrE,CAOA,mBAAmB,EAAO,EAAO,EAAS,GAAO,CAChD,KAAK,MAAQ,EACT,KAAK,SACR,MAAK,QAAQ,UAAU,OAAO,WAAY,EAAK,EAC/C,KAAK,QAAU,MAEhB,aAAa,KAAK,gBAAgB,EAC9B,EAAM,SAAW,GAAG,GAAS,IACjC,GAAM,GAAQ,EAAS,EAAM,OAAS,EAAI,KAAK,mBAAqB,KAAK,mBAAqB,EAAI,KAAK,mBAAqB,EAE5H,KAAK,iBAAmB,WAAW,GAAK,KAAK,iBAAiB,CAAK,EAAG,CAAK,CAC5E,CAKA,iBAAiB,EAAO,CACvB,KAAK,MAAQ,EACb,KAAK,mBAAmB,EACxB,GAAM,GAAO,KAAK,MAAM,IAAI,CAAK,EAEjC,AAAI,EACH,MAAK,iBAAiB,EAAK,OAAO,EAClC,KAAK,YAAY,EAAK,OAAO,EAC7B,KAAK,QAAU,EAAK,SAGpB,KAAK,QAAU,IAEjB,CAEA,YACA,aAIA,SAAS,EAAQ,CAAE,eAAe,IAAU,CAAC,EAAG,CAI/C,GAHA,KAAK,QAAU,EACf,QAAQ,IAAI,aAAc,KAAK,OAAO,EAElC,IAAiB,IAAQ,KAAK,cAAgB,GAAU,KAAK,eAAiB,KAAK,WAAY,OAKnG,GAHA,KAAK,YAAc,EACnB,KAAK,aAAe,KAAK,WAErB,EAAO,QAAU,EAAG,CACvB,KAAK,MAAM,QAAQ,GAAK,KAAK,mBAAmB,EAAE,QAAS,EAAK,CAAC,EACjE,KAAK,mBAAmB,EACxB,MACD,CAKA,KAAK,MAAM,QAAQ,GAAK,KAAK,mBAAmB,EAAE,QAAS,EAAI,CAAC,EAEhE,GAAM,GAAO,EAAO,YAAY,EAAE,MAAM,EAAE,EAG1C,WAAmB,EAAM,EAAS,CAAE,QAAQ,IAAS,CAAC,EAAG,CACxD,GAAM,GAAU,CAAC,EACX,EAAe,EAAQ,YAAY,EAAE,MAAM,EAAE,EAC/C,EAAe,EAAG,EAAe,EACjC,EAAK,EAAG,EAAK,EAAK,GAAI,EAAY,GAClC,EAAY,EACV,EAAU,CAAC,EACX,EAAqB,MAAM,CAChC,AAAI,EAAY,GAAc,GAAe,GAC7C,EAAY,CACb,EAH2B,sBAI3B,OAAS,GAAI,EAAG,EAAI,EAAa,OAAQ,IACxC,GAAI,EAAa,KAAO,EAAI,CAC3B,EAAQ,KAAK,CAAC,EAEd,AAAI,IAAc,EAAI,EACrB,GAAQ,KAAK,GAAI,GAAM,EAAG,gBAAgB,QAAQ,CAAC,EACnD,IACA,KAGA,GAAQ,KAAK,GAAI,GAAM,EAAG,UAAU,QAAQ,CAAC,EAC7C,EAAmB,GAEpB,EAAY,EAEZ,GAAM,GAAW,KAAK,QAAQ,KAAK,MAAO,GAAa,OAAS,GAAK,CAAC,EAAG,EAAG,CAAC,EAI7E,GAHI,EAAW,GAAG,EAAQ,KAAK,GAAI,GAAM,EAAU,eAAe,GAAU,CAAC,EAE7E,EAAK,EAAK,EAAE,GACR,IAAO,OAAW,KACvB,CAED,EAAmB,EAGnB,AAAI,EAAQ,OAAS,EAAG,EAAQ,KAAK,GAAI,GAAM,EAAQ,OAAS,EAAG,0BAA0B,EAAQ,OAAS,GAAG,CAAC,EAC7G,EAAQ,KAAK,GAAI,GAAM,KAAM,kBAAkB,CAAC,EASrD,GAAM,GAAO,EAAQ,QAAU,EAAK,OACpC,AAAI,GAAM,EAAQ,KAAK,GAAI,GAAM,GAAI,iBAAiB,CAAC,EAGvD,GAAM,GAAO,EAAQ,OAAS,KAAK,MAAM,EAAK,OAAS,CAAC,EAAI,EAC5D,GAAI,EAAO,CACV,GAAM,GAAa,EAAQ,OAAO,CAAC,EAAM,IAAQ,EAAI,MAAQ,CAAI,EAChE,EAAY,CAAC,KAAK,MAAM,EAAa,CAAC,EACvC,AAAI,GAAM,EAAQ,KAAK,GAAI,GAAM,EAAW,kBAAkB,GAAW,CAAC,EACtE,GAAgB,GAAG,EAAQ,KAAK,GAAI,GAAM,IAAK,mBAAmB,CAAC,CACxE,CAEA,MAAO,IAAI,IAAU,CAAE,UAAS,OAAM,OAAM,MAAQ,GAAe,GAAK,EAAK,OAAQ,eAAc,eAAc,SAAQ,CAAC,CAC3H,CA3DS,iBA6DT,GAAI,GAAe,EAAG,EAAe,EAI/B,EAAU,KAAK,MAAM,OAAO,CAAC,EAAS,IAAW,CACtD,GAAM,GAAY,EAAU,EAAM,EAAO,IAAI,EAC5C,EAAW,EAAU,EAAM,EAAO,GAAG,EAEtC,AAAI,EAAS,MAAM,IACf,EAAU,MAAM,IAEpB,GAAI,GAAQ,EAAU,MAAQ,GAC7B,EAAQ,EAAU,MAEnB,MAAI,MAAK,UACR,GAAU,OAAS,EACnB,EAAQ,EAAS,MACjB,EAAQ,EAAS,MAAQ,EAAU,OAGnC,IAAS,EAAS,MAAQ,EAC1B,GAAS,GAGV,EAAQ,KAAK,GAAI,GAAa,CAC7B,KAAM,EAAO,KACb,QACA,SACA,SAAU,KAAK,UACf,MAAO,EAAU,MAAQ,EAAI,EAAS,MAAQ,EAC9C,aAAc,EAAS,KACvB,cAAe,EAAU,KACzB,YAAa,EAAU,QACvB,WAAY,EAAS,QACrB,QACA,QAAS,CAAE,KAAM,EAAU,QAAS,IAAK,EAAS,OAAQ,CAC3D,CAAC,CAAC,EAEK,CACR,EAAG,CAAC,CAAC,EAEL,EAAQ,KAAK,CAAC,EAAG,IACZ,EAAE,MAAQ,CAAC,EAAE,KAAa,GAC1B,EAAE,MAAQ,CAAC,EAAE,KAAa,EACvB,EAAE,MAAQ,EAAE,KACnB,EAED,GAAI,GAAQ,CAAC,EAGb,GAAI,CACH,EAAQ,QAAQ,CAAC,EAAG,IAAU,CAC7B,GAAM,GAAK,EAAE,OAAO,QACpB,EAAG,QAAQ,YAAc,GAAG,EAAE,QAC9B,EAAG,QAAQ,YAAc,GAAG,EAAE,QAE9B,GAAI,GAAI,SACR,AAAI,EAAE,SAAU,EAAI,WACf,AAAI,EAAE,IAAK,EAAI,MACX,EAAE,MAAM,GAAI,QACrB,EAAG,QAAQ,aAAe,EAE1B,AAAI,EAAe,EACd,EAAE,MAAQ,KAAK,gBAAgB,KAAK,iBAAiB,CAAE,EAElD,EAAE,KACX,KAAK,iBAAiB,CAAE,CAK1B,CAAC,CACF,OACO,EAAP,CACC,GAAI,IAAQ,EAAO,KAAM,EAC1B,CAEA,KAAK,mBAAmB,CACzB,CAKA,KAAM,OAAM,EAAM,CAEjB,aAAO,MAAK,SAAS,KAAK,KAAK,OACxB,MAAM,MAAM,CAAI,CACxB,CAEA,OAAO,EAAQ,GAAO,EAAU,CAAC,EAAG,CACnC,MAAK,GAAQ,WACZ,MAAK,UAAY,OACjB,KAAK,YAAc,OACnB,KAAK,aAAe,OACpB,KAAK,WAAa,OAClB,KAAK,YAAc,QAGb,MAAM,OAAO,EAAO,CAAO,CACnC,CACD,EAh0Ba,2BCnHb,YAAuB,EAAK,CAC3B,GAAM,GAAS,OAAO,OAAO,EAAI,IAAI,EAAE,KAAK,GAAO,EAAI,WAAa,GAAO,YAAe,EAAmB,EAC7G,AAAI,EACH,GAAO,SAAS,EAChB,EAAO,WAAW,GAEd,GAAI,GAAoB,CAAG,EAAE,OAAO,EAAI,CAC9C,CAPS,sBAST,YAA0B,EAAO,EAAS,CACzC,EAAQ,QAAQ,CACf,MAAO,iBACP,KAAM,cACN,MAAO,KAAK,KAAK,SAAS,sCAAsC,EAChE,QAAS,GAAK,GAAc,EAAM,QAAQ,CAC3C,CAAC,CACF,CAPS,yBAST,GAAM,IAAN,KAAwB,CACvB,MAAO,SAAQ,EAAK,CACnB,GAAM,GAAM,CAAC,EAAG,EAAM,CAAC,EAEjB,EAAU,CAAC,cAAe,UAAU,EAEtC,EAAQ,EACZ,EAAG,CACF,GAAI,EAAM,YAAY,OAAS,SAAU,MACzC,GAAM,GAAQ,OAAO,oBAAoB,CAAK,EAC9C,OAAW,KAAQ,GAAO,CACzB,GAAI,EAAQ,SAAS,CAAI,EAAG,SAC5B,GAAM,GAAO,OAAO,yBAAyB,EAAO,CAAI,EACxD,AAAI,CAAC,GAEL,CAAI,EAAK,MAAQ,OAChB,EAAI,KAAK,CAAE,OAAM,KAAM,QAAS,CAAC,EACzB,MAAO,GAAK,OAAU,YAC9B,EAAI,KAAK,CAAE,OAAM,KAAM,UAAW,CAAC,EACrC,CAEA,EAAQ,OAAO,eAAe,CAAK,CACpC,OACO,GAEP,MAAO,CAAC,GAAG,EAAK,GAAG,CAAG,CACvB,CACD,EA3BM,0BA6BN,MAAM,KAAK,QAAS,SAAY,CAC/B,GAAM,GAAa,GAAI,QAAO,YAAY,EAAI,SAAS,EAIvD,GAAI,CADe,KAAK,SAAS,IAAI,EAAI,OAAQ,EAAI,SAAS,UAAU,GACrD,CAAC,KAAK,KAAK,KAAM,OAEpC,GAAM,GAAY,CAAC,SAAU,YAAa,QAAS,aAAa,EAEhE,MAAM,GAAG,6BAA8B,EAAgB,EACvD,MAAM,GAAG,4BAA6B,EAAgB,EAEtD,WAAW,eAAe,wBAAyB,GAAkB,OAAO,EAE5E,KAAM,eAAc,EAAU,IAAI,GAAK,WAAW,EAAI,mBAAmB,OAAO,CAAC,EAEjF,GAAM,GAAM,KAAK,QAAQ,IAAI,EAAI,MAAM,EAEvC,EAAI,IAAM,CACT,QAAS,EACV,EAGA,GAAM,GAAgB,WAAW,EAAI,kBAAkB,KAAK,OAAO,SAC7D,EAAI,EAAI,OACd,MAAM,EAAe,CAAE,OAAQ,OAAQ,MAAO,WAAY,SAAU,QAAS,CAAC,EAC5E,KAAK,SAAU,EAAU,CACzB,GAAI,EAAS,SAAW,KAAO,CAAC,EAAS,GAAI,CAC5C,QAAQ,IAAI,uEAAiE,EAAE,KAAM,EAAE,KAAK,EAC5F,MACD,CACA,OAAO,aAAa,KAAK,OAAO,UAC9B,KAAK,GAAK,QAAQ,IAAI,oEAA8D,EAAE,KAAM,EAAE,KAAK,CAAC,CACvG,CAAC,EAEF,GAAM,GAAK,EAAW,CAAG,EACzB,QAAQ,IAAI,oCAA6B,EAAG,oBAAqB,EAAE,KAAM,EAAE,MAAO,EAAE,GAAI,EAAE,KAAK,CAChG,CAAC",
  "names": []
}
