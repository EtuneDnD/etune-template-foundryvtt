const _0x126d67=_0x3e13;(function(_0x9415e0,_0x49985b){const _0x5916a2=_0x3e13,_0x4db0f2=_0x9415e0();while(!![]){try{const _0x44a4bd=parseInt(_0x5916a2(0x1cf))/0x1*(parseInt(_0x5916a2(0x26b))/0x2)+parseInt(_0x5916a2(0x1d7))/0x3*(parseInt(_0x5916a2(0x1de))/0x4)+-parseInt(_0x5916a2(0x203))/0x5+-parseInt(_0x5916a2(0x212))/0x6*(parseInt(_0x5916a2(0x228))/0x7)+parseInt(_0x5916a2(0x292))/0x8*(-parseInt(_0x5916a2(0x2fd))/0x9)+parseInt(_0x5916a2(0x2a8))/0xa*(parseInt(_0x5916a2(0x20f))/0xb)+-parseInt(_0x5916a2(0x1d1))/0xc*(-parseInt(_0x5916a2(0x22a))/0xd);if(_0x44a4bd===_0x49985b)break;else _0x4db0f2['push'](_0x4db0f2['shift']());}catch(_0x122ba9){_0x4db0f2['push'](_0x4db0f2['shift']());}}}(_0x2923,0xe77fd));import{SharedConsts}from'../shared/SharedConsts.js';import{Util}from'./Util.js';import{Config}from'./Config.js';import{Vetools}from'./Vetools.js';import{AppSourceSelectorMulti}from'./AppSourceSelectorMulti.js';import{ImportListRace}from'./ImportListRace.js';import{Charactermancer_Class_ProficiencyImportModeSelect,Charactermancer_Class_Util,PageFilterClassesFoundry}from'./UtilCharactermancerClass.js';import{ImportListClass}from'./ImportListClass.js';import{Charactermancer_StartingEquipment}from'./UtilCharactermancerEquipment.js';import{ImportListBackground}from'./ImportListBackground.js';import{ImportListFeat}from'./ImportListFeat.js';import{UtilApplications}from'./UtilApplications.js';import{ActorCharactermancerRace}from'./ActorCharactermancerRace.js';import{ActorCharactermancerBaseComponent}from'./ActorCharactermancerUtil.js';function _0x3e13(_0x1080c4,_0x2fce84){const _0x2923a1=_0x2923();return _0x3e13=function(_0x3e1380,_0x2b5cc1){_0x3e1380=_0x3e1380-0x1c2;let _0x54bd32=_0x2923a1[_0x3e1380];return _0x54bd32;},_0x3e13(_0x1080c4,_0x2fce84);}import{ActorCharactermancerEquipment}from'./ActorCharactermancerEquipment.js';import{ActorCharactermancerBackground}from'./ActorCharactermancerBackground.js';import{ActorCharactermancerClass}from'./ActorCharactermancerClass.js';import{ActorCharactermancerFeat}from'./ActorCharactermancerFeat.js';import{ActorCharactermancerSpell}from'./ActorCharactermancerSpell.js';import{ActorCharactermancerAbility}from'./ActorCharactermancerAbility.js';import{UtilDataSource}from'./UtilDataSource.js';function _0x2923(){const _0x13261f=['isStreamerMode','pGetHomebrewSources','_foundryIsSkipCustomizeLanguagesTools','isPrimary','pGetItems','class_ixPrimaryClass','compsSpellSpellSlotLevelSelect','compClass','register','pDoApplyResourcesFormDataToActor','_foundryAllFeatures','_BREW_DIRS','all','pDoApplySensesFormDataToActor','_doSwitchToPrevTab','subclass','_pLoadVetoolsSource','actor','error','ability','isCustomizeLanguagesTools','equipmentItemEntries','_pHandleSaveClick_background','senses','SRD','weaponProficiencies','SOURCE_TYP_OFFICIAL_ALL','Abilities','addFauxOptionalFeatureEntries','_preInit_registerKeybinds','5etools','filterValuesSpellsCache','_compSpell','click','features','getTotals','getFlagsChoicesState','compBackgroundWeaponProficiencies','_foundryIsSkipImportCantrips','2ToCnWB','copy','update','Imported\x20race.','TabMeta','pGetRaces','MODULE_NAME','Imported\x20classes\x20and\x20subclasses.','pApplyFormDataToActor','compRaceWeaponProficiencies','compSpell','activateListeners','_pRender_renderTabAbilities','_pRender_renderTabClass','isAnyChoice','_comp','getPlayerActor','item','currency','isPatron','_hasPrevTab','armorProficiencies','DATA_URL_FEATS','ActorCharactermancerSourceSelector_filter','_pHandleSaveClick','spellcastingAbility','get','max','_pRender','_foundryConInitial','pDoApplyProficiencyFormDataToActorUpdate','compsSpellAdditionalSpellClass','DataSourceFile','_pHandleSaveClick_feats','pGetShowLoginDialogue','compRaceDamageVulnerability','ascSort','pGetClassSubclassFeatureIgnoredLookup','_doSwitchToNextTab','669624WqzQXK','bind','languageProficiencies','savingThrowProficiencies','Build\x20complete!','_compClass','last','_pHandleSaveClick_abilities','feats','compsClassLevelSelect','Imported\x20spells.','_compEquipment','_pPostLoad','class_ixMax','compRaceSkillToolLanguageProficiencies','getDedupedData','getCurrentAbilityScores','isFiltered','_render_loading','compFeat','entity','Charactermancer\x20(Actor\x20\x22','10VaIadu','compEquipmentShopGold','_pLoad','<button\x20class=\x22btn\x20btn-5et\x20btn-default\x20w-100p\x22>Next</button>','close','_versions','ActorCharactermancerSourceSelector_savedSelection','pInit','isCancelled','pImportEntry','compRaceSkillProficiencies','mutateForFilters','compBackgroundFeatures','empty','Build\x20failed!\x20','getBlocklistFilteredData','getValues','_render_pRenderTabEquipmentShop','5etools-charactermancer','pGetLocalHomebrewSources','compBackgroundSkillProficiencies','ActorCharactermancerSourceSelector__openForCurrentSheet','Starting\x20Equipment','_foundryIsSkipImportPreparedSpells','classFeature','Set\x20ability\x20scores.','_conInitialWithModifiers','_foundryFormDataFeatures','compBackgroundDamageVulnerability','activeTab_','keybindings','Upload\x20File','conditionImmune','pRenderShop','name','SKILL_TO_ATB_ABV','feat_pGetAdditionalFeatFormData','map','_postProcessAllSelectedData','filter','_compRace','class','_compFeat','compRace','pHandleButtonClick','append','_setActiveTab','_foundryIsSkipCustomizeSkills','compRaceSize','$btnTab','toolProficiencies','<button\x20class=\x22btn\x20btn-5et\x20btn-primary\x22>Finalize</button>','expertise','Custom\x20URL','Component','size','_actor','_fullEntries','cbPostSave','_pHandleSaveClick_pDoApplySkills','getClass_','Equipment\x20Shop','compsClassFeatureOptionsSelect','MODULE_LOCATION','getSubclass_','modalFilterClasses','_tabs','Race','data','assign','_pRender_renderTabRace','_foundryIsSkipImportCharacteristics','cls','pUpdateActorCurrency','addFauxOptionalFeatureFeatures','_tabShop','Importing\x20feats...','decorate','state','DataSourceSpecial','_cons_initTabs','DATA_URL_OPTIONALFEATURES','appendTo','render','totals','198GbNGer','Imported\x20feats.','mergeMap','startingEquipment','_conFinalWithModifiers','initFullEntries','compSpellAdditionalSpellRace','abilityChosen','pLoad','compBackgroundLanguageProficiencies','spell','conditionImmunities','_getActiveTab','compBackgroundToolProficiencies','SOURCE_TYP_BREW','pSerialAwaitMap','Importing\x20classes\x20and\x20subclasses...','vulnerable','damageResistances','_pHandleSaveClick_spells','_addHookActiveTab','forEach','delete','ActorCharactermancerSourceSelector__openForCharacter','compBackgroundArmorProficiencies','_pRender_renderTabBackground','<div\x20class=\x22ve-flex-vh-center\x20w-100\x20h-100\x22><i>Loading...</i></div>','compRaceDamageImmunity','resist','pImportEquipmentItemEntries','btn-sm','_foundryChosenAbilityScoreIncrease','502301LatEMA','Spells','216wyUrzf','subclasses','\x22):\x20Select\x20Sources','compsSpellAdditionalSpellSubclass','pRenderStarting','SOURCE_TYP_CUSTOM','3OSgyyA','system','getRace_','_pHandleSaveClick_class','pWaitForUserInput','compRaceArmorProficiencies','subrace','6430868bPLQoL','compRaceLanguageProficiencies','pPostLoadGeneric','featureSourceTracker_','_foundryHpIncreaseCustomFormula','DataSourceUrl','_pHandleSaveClick_postSave','Open\x20Charactermancer\x20Targeting\x20Current\x20Sheet','_render_pRenderTabEquipmentStarting','Class','catch','subclassFeature','compBackgroundDamageResistance','SOURCE_TYP_BREW_LOCAL','multiclassing','_pRender_renderTabFeats','immune','pGetUserBoolean','<hr\x20class=\x22hr-1\x20w-100\x22>','AdditionalSaveState','/template/Charactermancer.hbs','filterBox','feat','_compAbility','MODE_NONE','compStatgen','MODE_MULTICLASS','Utils','type','MODE_PRIMARY','_renderTabs','Failed\x20to\x20load!\x20','pDoApplyAdditionalSpellsFormDataToActor','filterBoxSpells','compBackgroundCharacteristics','getMergedData','_pGetSources','3394455gbrqDA','getCurrentImportableSheetDocumentMeta','getMaxWindowWidth','set','DATA_URL_BACKGROUNDS','keys','skillProficiencies','pGetWithCache','_pHandleSaveClick_equipment','background','pGetFormData','mode','7453127NDiHys','Build\x20Complete','_cbPostSave','1123386qKSltX','push','race','Open\x20Charactermancer\x20Targeting\x20Player\x20Character','damageImmunities','_isLevelUp','compsClassSkillProficiencies','_pRender_pRenderTabSpells','_foundryFormDataCharacteristics','_tabEquipment','_data','_pHandleSaveClick_','Setting\x20ability\x20scores...','_pHandleSaveClick_pDoImportAdditionalSpells','Running\x20post-build\x20step...','proficienciesGained','_pOpen','notifications','Importing\x20background...','pPostLoad','Imported\x20equipment.','_featureSourceTracker','63LMOACY','pageFilter','1708837QBICLz','length','_pHandleSaveClick_pDoApplyTraitLike','compBackgroundLanguageToolProficiencies','$wrpTab','compsSpellSpells','Build\x20cancelled.','compBackgroundDamageImmunity','ptrTaskProgress','setProgress','pUpdateDocument','optionalfeature','_compBackground','pRender','Building...','progressWidget','compBackgroundExpertise','isAnyData','additionalSpells','isStandardStartingEquipmentActive_','skills','STR_SEE_CONSOLE','Feats','disabled','compsClassHpIncreaseMode','prop'];_0x2923=function(){return _0x13261f;};return _0x2923();}import{Charactermancer_FeatureOptionsSelect,Charactermancer_FeatureSourceTracker,Charactermancer_Util}from'./UtilCharactermancer.js';import{Charactermancer_AdditionalSpellsSelect}from'./UtilCharactermancerAdditionalSpells.js';import{Charactermancer_Spell}from'./UtilCharactermancerSpell.js';import{UtilDocuments}from'./UtilDocuments.js';import{UtilWorldDataSourceSelector}from'./UtilWorldDataSourceSelector.js';import{Charactermancer_Feature_Util}from'./UtilCharactermancerFeature.js';import{UtilKeybinding}from'./UtilKeybinding.js';import{UtilPatreon}from'./UtilPatreon.js';class ActorCharactermancerSourceSelector extends AppSourceSelectorMulti{static['prePreInit'](){const _0x5e63eb=_0x3e13;this[_0x5e63eb(0x261)]();}static[_0x126d67(0x261)](){const _0x198a4a=_0x126d67,_0x3793fd=({modeId:modeId=null}={})=>{const _0x18f42a=_0x3e13,_0x301dcb=UtilKeybinding[_0x18f42a(0x27b)]();if(!_0x301dcb)return!![];return this[_0x18f42a(0x222)]({'modeId':modeId,'actor':_0x301dcb}),!![];},_0x5d59f6=({modeId:modeId=null}={})=>{const _0x2332b0=_0x3e13,_0x3d28b6=UtilKeybinding[_0x2332b0(0x204)]({'isRequireActor':!![]});if(!_0x3d28b6?.[_0x2332b0(0x255)])return!![];return this[_0x2332b0(0x222)]({'modeId':modeId,..._0x3d28b6}),!![];};game['keybindings'][_0x198a4a(0x24c)](SharedConsts['MODULE_NAME'],_0x198a4a(0x1c6),{'name':_0x198a4a(0x215),'editable':[],'onDown':()=>_0x3793fd()}),game[_0x198a4a(0x2c6)][_0x198a4a(0x24c)](SharedConsts[_0x198a4a(0x271)],_0x198a4a(0x2bd),{'name':_0x198a4a(0x1e5),'editable':[],'onDown':()=>_0x5d59f6()});}static async[_0x126d67(0x2d4)](_0x255e5e,_0x59343c,_0x27601c,_0x429107){const _0x55bb07=_0x126d67;if(!(await UtilPatreon[_0x55bb07(0x28d)]())?.[_0x55bb07(0x27e)])return;return this[_0x55bb07(0x222)]({'actor':_0x59343c[_0x55bb07(0x255)]});}static async[_0x126d67(0x222)]({actor:_0x19a967}){const _0x3c0336=_0x126d67,_0x496cc4=await this[_0x3c0336(0x202)]({'actor':_0x19a967}),_0x22a848=new ActorCharactermancerSourceSelector({'title':'Charactermancer\x20(Actor\x20\x22'+_0x19a967[_0x3c0336(0x2ca)]+_0x3c0336(0x1d3),'filterNamespace':_0x3c0336(0x282),'savedSelectionKey':_0x3c0336(0x2ae),'sourcesToDisplay':_0x496cc4}),_0x3a7043=await _0x22a848[_0x3c0336(0x1db)]();if(_0x3a7043==null)return;const _0x133ca3=this[_0x3c0336(0x2ce)](_0x3a7043),_0x1299c8=new ActorCharactermancer({'actor':_0x19a967,'data':_0x133ca3});_0x1299c8[_0x3c0336(0x2fb)](!![]);}static[_0x126d67(0x2ce)](_0x178db2){const _0x3ebb37=_0x126d67;return _0x178db2=ImportListClass[_0x3ebb37(0x1f9)][_0x3ebb37(0x2a1)]({'allContentMerged':_0x178db2}),_0x178db2=ImportListClass[_0x3ebb37(0x1f9)][_0x3ebb37(0x2b7)]({'dedupedAllContentMerged':_0x178db2}),delete _0x178db2[_0x3ebb37(0x253)],Charactermancer_Feature_Util[_0x3ebb37(0x260)](_0x178db2,_0x178db2['optionalfeature']),Charactermancer_Class_Util[_0x3ebb37(0x2f2)](_0x178db2['class'],_0x178db2[_0x3ebb37(0x235)]),_0x178db2;}static async['_pGetSources']({actor:_0x42b098}){const _0x131169=_0x126d67;return[new UtilDataSource[(_0x131169(0x2f7))](Config[_0x131169(0x285)]('ui',_0x131169(0x244))?_0x131169(0x25c):_0x131169(0x262),this['_pLoadVetoolsSource'][_0x131169(0x293)](this),{'cacheKey':_0x131169(0x2ba),'filterTypes':[UtilDataSource[_0x131169(0x25e)]],'isDefault':!![],'pPostLoad':this[_0x131169(0x29e)][_0x131169(0x293)](this,{'isVetools':!![],'actor':_0x42b098})}),new UtilDataSource[(_0x131169(0x1e3))](_0x131169(0x2dd),'',{'pPostLoad':this[_0x131169(0x29e)]['bind'](this,{'isVetools':![],'actor':_0x42b098}),'filterTypes':[UtilDataSource['SOURCE_TYP_CUSTOM']]}),new UtilDataSource[(_0x131169(0x28b))](_0x131169(0x2c7),{'pPostLoad':this['_pPostLoad'][_0x131169(0x293)](this,{'isVetools':![],'actor':_0x42b098}),'filterTypes':[UtilDataSource[_0x131169(0x1d6)]]}),...(await Vetools[_0x131169(0x2bb)](...ActorCharactermancerSourceSelector[_0x131169(0x24f)]))['map'](({name:_0x43e9fb,url:_0x1202cd})=>new UtilDataSource[(_0x131169(0x1e3))](_0x43e9fb,_0x1202cd,{'pPostLoad':this[_0x131169(0x29e)]['bind'](this,{'isVetools':![],'actor':_0x42b098}),'filterTypes':[UtilDataSource[_0x131169(0x30b)],UtilDataSource[_0x131169(0x1eb)]]})),...(await Vetools[_0x131169(0x245)](...ActorCharactermancerSourceSelector[_0x131169(0x24f)]))[_0x131169(0x2cd)](({name:_0x525179,url:_0xfb8904})=>new UtilDataSource[(_0x131169(0x1e3))](_0x525179,_0xfb8904,{'pPostLoad':this[_0x131169(0x29e)][_0x131169(0x293)](this,{'isVetools':![],'actor':_0x42b098}),'filterTypes':[UtilDataSource['SOURCE_TYP_BREW']]}))][_0x131169(0x2cf)](_0x465f31=>!UtilWorldDataSourceSelector[_0x131169(0x2a3)](_0x465f31));}static async[_0x126d67(0x254)](){const _0x3833a8=_0x126d67,_0x367439={},[_0x158e94,_0x3eccc9,_0x5e344b,_0x300257,_0x58f987,_0x179a5f,_0xba795a]=await Promise[_0x3833a8(0x250)]([Vetools['pGetClasses'](),Vetools[_0x3833a8(0x270)](),Vetools[_0x3833a8(0x20a)](Vetools[_0x3833a8(0x207)]),Vetools[_0x3833a8(0x248)](),Vetools['pGetAllSpells'](),Vetools['pGetWithCache'](Vetools[_0x3833a8(0x281)]),Vetools[_0x3833a8(0x20a)](Vetools[_0x3833a8(0x2f9)])]);return Object['assign'](_0x367439,_0x158e94),_0x367439[_0x3833a8(0x214)]=_0x3eccc9[_0x3833a8(0x214)],_0x367439[_0x3833a8(0x20c)]=_0x5e344b[_0x3833a8(0x20c)],_0x367439[_0x3833a8(0x27c)]=_0x300257[_0x3833a8(0x27c)],_0x367439[_0x3833a8(0x307)]=_0x58f987[_0x3833a8(0x307)],_0x367439['feat']=_0x179a5f[_0x3833a8(0x1f4)],_0x367439[_0x3833a8(0x235)]=_0xba795a['optionalfeature'],_0x367439;}static async['_pPostLoad']({isVetools:_0x2d76fd,actor:_0x1dc930},_0x594345){const _0x54e469=_0x126d67;_0x594345=await UtilDataSource[_0x54e469(0x1e0)]({'isVetools':_0x2d76fd},_0x594345);if(_0x594345['class']||_0x594345['subclass']){const {DataConverterClassSubclassFeature:_0x5ded0d}=await import('./DataConverterClassSubclassFeature.js'),_0x3063cb=await _0x5ded0d[_0x54e469(0x290)]({'data':_0x594345}),_0x427450=await PageFilterClassesFoundry[_0x54e469(0x225)]({'class':_0x594345[_0x54e469(0x2d1)],'subclass':_0x594345['subclass'],'classFeature':_0x594345[_0x54e469(0x2c0)],'subclassFeature':_0x594345[_0x54e469(0x1e9)]},{'actor':_0x1dc930,'isIgnoredLookup':_0x3063cb});Object[_0x54e469(0x2ed)](_0x594345,_0x427450);if(_0x594345[_0x54e469(0x2d1)])_0x594345[_0x54e469(0x2d1)][_0x54e469(0x1c4)](_0x162f8b=>PageFilterClasses[_0x54e469(0x2b3)](_0x162f8b));}if(_0x594345[_0x54e469(0x1f4)])_0x594345['feat']=MiscUtil[_0x54e469(0x26c)](_0x594345[_0x54e469(0x1f4)]);if(_0x594345[_0x54e469(0x235)])_0x594345[_0x54e469(0x235)]=MiscUtil[_0x54e469(0x26c)](_0x594345[_0x54e469(0x235)]);return _0x594345;}}ActorCharactermancerSourceSelector['_BREW_DIRS']=[_0x126d67(0x2d1),_0x126d67(0x253),_0x126d67(0x214),_0x126d67(0x1dd),_0x126d67(0x27c),'background',_0x126d67(0x27c),_0x126d67(0x307),_0x126d67(0x1f4),_0x126d67(0x235)];class ActorCharactermancer extends Application{static ['_DATA_PROPS_EXPECTED']=['class',_0x126d67(0x253),_0x126d67(0x2c0),_0x126d67(0x1e9),'race',_0x126d67(0x20c),_0x126d67(0x27c),_0x126d67(0x307),_0x126d67(0x1f4),'optionalfeature'];constructor(_0x18fd3b){const _0x575128=_0x126d67;_0x18fd3b=_0x18fd3b||{},super({'title':_0x575128(0x2a7)+_0x18fd3b[_0x575128(0x255)][_0x575128(0x2ca)]+'\x22)','template':SharedConsts[_0x575128(0x2e7)]+_0x575128(0x1f2),'width':Util[_0x575128(0x205)](0x4b0),'height':Util['getMaxWindowHeight'](),'resizable':!![]});const _0x3a1729=UtilDataSource[_0x575128(0x201)]([_0x18fd3b[_0x575128(0x2ec)]]);ActorCharactermancer['_DATA_PROPS_EXPECTED'][_0x575128(0x1c4)](_0x49ee72=>_0x3a1729[_0x49ee72]=_0x3a1729[_0x49ee72]||[]),this[_0x575128(0x27a)]=new ActorCharactermancer['Component']({'actor':_0x18fd3b[_0x575128(0x255)],'data':_0x3a1729,'cbPostSave':this[_0x575128(0x2ac)]['bind'](this)});}[_0x126d67(0x276)](_0x261de7){const _0x4d19e1=_0x126d67;this[_0x4d19e1(0x27a)][_0x4d19e1(0x2fb)](_0x261de7);}}ActorCharactermancer[_0x126d67(0x2de)]=class extends ActorCharactermancerBaseComponent{constructor(_0x21e96f){const _0x37dd98=_0x126d67;_0x21e96f=_0x21e96f||{},super(),TabUiUtil[_0x37dd98(0x2f5)](this),this[_0x37dd98(0x2e0)]=_0x21e96f[_0x37dd98(0x255)],this[_0x37dd98(0x21c)]=_0x21e96f[_0x37dd98(0x2ec)],this[_0x37dd98(0x211)]=_0x21e96f[_0x37dd98(0x2e2)],this[_0x37dd98(0x227)]=new Charactermancer_FeatureSourceTracker(),this[_0x37dd98(0x217)]=Charactermancer_Util['getCurrentLevel'](this['_actor'])>0x0,this[_0x37dd98(0x2ea)]=null;const {tabClass:_0x3e280c,tabRace:_0x172262,tabAbilities:_0x326c87,tabBackground:_0x3ba30b,tabEquipment:_0x1ab2b4,tabShop:_0x660529,tabSpells:_0xbb518b,tabFeats:_0x216b19}=this[_0x37dd98(0x2f8)]();this[_0x37dd98(0x21b)]=_0x1ab2b4,this[_0x37dd98(0x2f3)]=_0x660529,this[_0x37dd98(0x297)]=new ActorCharactermancerClass({'actor':_0x21e96f[_0x37dd98(0x255)],'data':_0x21e96f['data'],'parent':this,'tabClass':_0x3e280c}),this[_0x37dd98(0x2d0)]=new ActorCharactermancerRace({'actor':_0x21e96f[_0x37dd98(0x255)],'data':_0x21e96f['data'],'parent':this,'tabRace':_0x172262}),this['_compAbility']=new ActorCharactermancerAbility({'actor':_0x21e96f[_0x37dd98(0x255)],'data':_0x21e96f[_0x37dd98(0x2ec)],'parent':this,'tabAbilities':_0x326c87}),this[_0x37dd98(0x236)]=new ActorCharactermancerBackground({'actor':_0x21e96f[_0x37dd98(0x255)],'data':_0x21e96f[_0x37dd98(0x2ec)],'parent':this,'tabBackground':_0x3ba30b}),this[_0x37dd98(0x29d)]=new ActorCharactermancerEquipment({'actor':_0x21e96f[_0x37dd98(0x255)],'data':_0x21e96f['data'],'parent':this,'tabEquipment':_0x1ab2b4,'tabShop':_0x660529}),this[_0x37dd98(0x264)]=new ActorCharactermancerSpell({'actor':_0x21e96f['actor'],'data':_0x21e96f[_0x37dd98(0x2ec)],'parent':this,'tabSpells':_0xbb518b}),this[_0x37dd98(0x2d2)]=new ActorCharactermancerFeat({'actor':_0x21e96f['actor'],'data':_0x21e96f['data'],'parent':this,'tabFeats':_0x216b19}),this['_conInitialWithModifiers']=null,this[_0x37dd98(0x301)]=null;}[_0x126d67(0x2f8)](){const _0x2cca0a=_0x126d67;this[_0x2cca0a(0x217)]?this['_tabs']=this['_renderTabs']([new TabUiUtil['TabMeta']({'name':_0x2cca0a(0x1e7),'hasBorder':!![]}),new TabUiUtil[(_0x2cca0a(0x26f))]({'name':_0x2cca0a(0x25f),'hasBorder':!![]}),new TabUiUtil[(_0x2cca0a(0x26f))]({'name':'Spells','hasBorder':!![]}),new TabUiUtil[(_0x2cca0a(0x26f))]({'name':_0x2cca0a(0x240),'hasBorder':!![]})],{'propProxy':_0x2cca0a(0x2f6)}):this['_tabs']=this[_0x2cca0a(0x1fc)]([new TabUiUtil[(_0x2cca0a(0x26f))]({'name':_0x2cca0a(0x1e7),'hasBorder':!![]}),new TabUiUtil['TabMeta']({'name':_0x2cca0a(0x2eb),'hasBorder':!![]}),new TabUiUtil['TabMeta']({'name':_0x2cca0a(0x25f),'hasBorder':!![]}),new TabUiUtil[(_0x2cca0a(0x26f))]({'name':'Background','hasBorder':!![]}),new TabUiUtil['TabMeta']({'name':_0x2cca0a(0x2be),'hasBorder':!![]}),new TabUiUtil[(_0x2cca0a(0x26f))]({'name':_0x2cca0a(0x2e5),'hasBorder':!![]}),new TabUiUtil['TabMeta']({'name':_0x2cca0a(0x1d0),'hasBorder':!![]}),new TabUiUtil['TabMeta']({'name':'Feats','hasBorder':!![]})],{'propProxy':_0x2cca0a(0x2f6)});if(this['_isLevelUp']){const [_0x13248b,_0x27540d,_0x130d09,_0x261f94]=this[_0x2cca0a(0x2ea)];return{'tabClass':_0x13248b,'tabAbilities':_0x27540d,'tabSpells':_0x130d09,'tabFeats':_0x261f94};}else{const [_0x5321ce,_0x370941,_0x348381,_0x1a6318,_0x21b346,_0x3d2fda,_0x12c3ef,_0x3fda1a]=this[_0x2cca0a(0x2ea)];return{'tabClass':_0x5321ce,'tabRace':_0x370941,'tabAbilities':_0x348381,'tabBackground':_0x1a6318,'tabEquipment':_0x21b346,'tabShop':_0x3d2fda,'tabSpells':_0x12c3ef,'tabFeats':_0x3fda1a};}}get[_0x126d67(0x1e1)](){const _0x24f4fb=_0x126d67;return this[_0x24f4fb(0x227)];}get[_0x126d67(0x24b)](){const _0x4a31ca=_0x126d67;return this[_0x4a31ca(0x297)];}get[_0x126d67(0x2d3)](){return this['_compRace'];}get['compBackground'](){const _0x305111=_0x126d67;return this[_0x305111(0x236)];}get['compEquipment'](){const _0x56ca66=_0x126d67;return this[_0x56ca66(0x29d)];}get[_0x126d67(0x275)](){return this['_compSpell'];}get[_0x126d67(0x2a5)](){const _0x2de46a=_0x126d67;return this[_0x2de46a(0x2d2)];}get['compAbility'](){const _0x3e1101=_0x126d67;return this[_0x3e1101(0x1f5)];}set[_0x126d67(0x2c5)](_0x11d0bc){const _0x387ae0=_0x126d67;this[_0x387ae0(0x2d6)]({'propProxy':_0x387ae0(0x2f6),'tab':_0x11d0bc});}[_0x126d67(0x2fb)](_0x40ac70){const _0x4c6534=_0x126d67;this[_0x4c6534(0x2a4)](_0x40ac70),this[_0x4c6534(0x2aa)]()['then'](()=>this[_0x4c6534(0x287)](_0x40ac70))[_0x4c6534(0x1e8)](_0x4a5894=>{const _0x42b0f2=_0x4c6534;ui[_0x42b0f2(0x223)][_0x42b0f2(0x256)](_0x42b0f2(0x1fd)+VeCt[_0x42b0f2(0x23f)]);throw _0x4a5894;});}[_0x126d67(0x2a4)](_0x63435d){const _0xca26ca=_0x126d67;_0x63435d[_0xca26ca(0x2d5)](_0xca26ca(0x1c9));}async[_0x126d67(0x2aa)](){const _0x2e825e=_0x126d67;await this[_0x2e825e(0x2d0)][_0x2e825e(0x305)](),await this[_0x2e825e(0x236)]['pLoad'](),await this[_0x2e825e(0x297)]['pLoad'](),await this[_0x2e825e(0x264)][_0x2e825e(0x305)](),await this['_compFeat'][_0x2e825e(0x305)]();}async[_0x126d67(0x287)](_0x1d33c5){const _0x12e675=_0x126d67;_0x1d33c5[_0x12e675(0x2b5)]();const _0x32e8cd=$('<button\x20class=\x22btn\x20btn-5et\x20btn-default\x20w-100p\x22>Previous</button>')[_0x12e675(0x265)](()=>this[_0x12e675(0x252)]({'propProxy':_0x12e675(0x2f6)})),_0x321eda=$(_0x12e675(0x2ab))[_0x12e675(0x265)](()=>{const _0x20df7a=_0x12e675;this[_0x20df7a(0x291)]({'propProxy':'state'}),(this['_getActiveTab']({'propProxy':'state'})===this[_0x20df7a(0x2f3)]&&this[_0x20df7a(0x29d)][_0x20df7a(0x23d)]()||this[_0x20df7a(0x309)]({'propProxy':'state'})===this[_0x20df7a(0x21b)]&&!this[_0x20df7a(0x29d)][_0x20df7a(0x23d)]())&&this['_doSwitchToNextTab']({'propProxy':_0x20df7a(0x2f6)});}),_0x25411a=()=>{const _0x29f271=_0x12e675;_0x32e8cd['prop'](_0x29f271(0x241),!this[_0x29f271(0x27f)]({'propProxy':_0x29f271(0x2f6)})),_0x321eda[_0x29f271(0x243)](_0x29f271(0x241),!this['_hasNextTab']({'propProxy':_0x29f271(0x2f6)}));};this[_0x12e675(0x1c3)](_0x25411a,{'propProxy':_0x12e675(0x2f6)}),_0x25411a();const _0x48d6e1=$(_0x12e675(0x2db))['click'](()=>{const _0x519fb2=_0x12e675;_0x48d6e1[_0x519fb2(0x243)](_0x519fb2(0x241),!![]);try{this[_0x519fb2(0x283)]();}finally{_0x48d6e1[_0x519fb2(0x243)](_0x519fb2(0x241),![]);}});$$`<div class="w-100 no-shrink ui-tab__wrp-tab-heads--border">
			${this[_0x12e675(0x2ea)]['map'](_0xfdb635=>_0xfdb635[_0x12e675(0x2d9)]['addClass'](_0x12e675(0x1cd)))}
		</div>`[_0x12e675(0x2fa)](_0x1d33c5),this[_0x12e675(0x2ea)][_0x12e675(0x1c4)](_0x394ca1=>_0x394ca1[_0x12e675(0x22e)][_0x12e675(0x2fa)](_0x1d33c5)),_0x1d33c5[_0x12e675(0x2d5)](_0x12e675(0x1f0)),$$`<div class="w-100 no-shrink ve-flex-h-right pr-3">
			<div class="ve-flex-v-center btn-group">${_0x32e8cd}${_0x321eda}</div>
			<div class="vr-2"></div>
			${_0x48d6e1}
		</div>`[_0x12e675(0x2fa)](_0x1d33c5),this[_0x12e675(0x278)](),this[_0x12e675(0x2ee)](),this[_0x12e675(0x277)](),this['_pRender_renderTabBackground'](),await this[_0x12e675(0x1e6)](),await this[_0x12e675(0x2b9)](),await this[_0x12e675(0x219)](),this[_0x12e675(0x1ed)]();}['_pRender_renderTabClass'](){const _0x346552=_0x126d67;this[_0x346552(0x297)][_0x346552(0x2fb)]();}[_0x126d67(0x2ee)](){const _0x55f459=_0x126d67;this[_0x55f459(0x2d0)][_0x55f459(0x2fb)]();}[_0x126d67(0x277)](){const _0x45f3ac=_0x126d67;this[_0x45f3ac(0x1f5)][_0x45f3ac(0x2fb)]();}[_0x126d67(0x1c8)](){const _0x32f540=_0x126d67;this[_0x32f540(0x236)][_0x32f540(0x2fb)]();}async[_0x126d67(0x1e6)](){const _0x261e12=_0x126d67;await this[_0x261e12(0x29d)][_0x261e12(0x1d5)]();}async['_render_pRenderTabEquipmentShop'](){const _0x1f328c=_0x126d67;await this[_0x1f328c(0x29d)][_0x1f328c(0x2c9)]();}async['_pRender_pRenderTabSpells'](){const _0x2a33b6=_0x126d67;await this['_compSpell'][_0x2a33b6(0x237)]();}[_0x126d67(0x1ed)](){const _0x14f3c5=_0x126d67;this[_0x14f3c5(0x2d2)]['render']();}async[_0x126d67(0x283)](){const _0x4f19a9=_0x126d67,_0x54adb3=await InputUiUtil[_0x4f19a9(0x1ef)]({'title':'Are\x20You\x20Sure?'});if(!_0x54adb3)return;const _0x12f3a6=[this[_0x4f19a9(0x299)][_0x4f19a9(0x293)](this),this[_0x4f19a9(0x217)]?null:this['_pHandleSaveClick_race'][_0x4f19a9(0x293)](this),this[_0x4f19a9(0x1da)]['bind'](this),this[_0x4f19a9(0x217)]?null:this[_0x4f19a9(0x25a)][_0x4f19a9(0x293)](this),this[_0x4f19a9(0x28c)]['bind'](this),this[_0x4f19a9(0x1c2)]['bind'](this),this[_0x4f19a9(0x217)]?null:this['_pHandleSaveClick_equipment'][_0x4f19a9(0x293)](this),this[_0x4f19a9(0x1e4)]['bind'](this)][_0x4f19a9(0x2cf)](Boolean),_0x144942=new UtilApplications['TaskRunner']({'titleInitial':_0x4f19a9(0x238),'titleComplete':_0x4f19a9(0x210),'totalTasks':_0x12f3a6[_0x4f19a9(0x22b)]});await _0x144942['pInit']();const _0x7ddc5c={'_':0x0};try{await this['_pHandleSaveClick_'](_0x12f3a6,_0x144942,_0x7ddc5c);}catch(_0x191932){_0x144942['setProgress']({'message':_0x4f19a9(0x2b6)+VeCt[_0x4f19a9(0x23f)],'count':_0x7ddc5c['_'],'isError':!![]});throw _0x191932;}}async[_0x126d67(0x21d)](_0x280ea9,_0x3aad51,_0x22ec93){const _0x407307=_0x126d67,_0x519439=new ActorCharactermancer[(_0x407307(0x2de))]['AdditionalSaveState']({'progressWidget':_0x3aad51,'ptrTaskProgress':_0x22ec93});for(const _0x5d33a3 of _0x280ea9)await _0x5d33a3(_0x519439);_0x3aad51[_0x407307(0x233)]({'message':_0x407307(0x296),'count':_0x22ec93['_']});}async[_0x126d67(0x299)](_0x4f1801){const _0x372990=_0x126d67,{progressWidget:_0x1f53c2,ptrTaskProgress:_0x3ab70f}=_0x4f1801;_0x1f53c2[_0x372990(0x233)]({'message':_0x372990(0x21e),'count':++_0x3ab70f['_']});if(_0x1f53c2[_0x372990(0x2b0)])return _0x1f53c2[_0x372990(0x233)]({'message':'Build\x20cancelled.'});if(this['_isLevelUp']){const {con:_0x512b91}=Charactermancer_Util[_0x372990(0x2a2)](this[_0x372990(0x2e0)]);this[_0x372990(0x2c2)]=_0x512b91;}const _0x222e9f=this[_0x372990(0x1f5)][_0x372990(0x1f7)][_0x372990(0x267)]();if(_0x222e9f['mode']!==StatGenUi[_0x372990(0x1f6)]){const _0x569973={'system':{'abilities':{...Parser['ABIL_ABVS'][_0x372990(0x2ff)](_0x41c661=>({[_0x41c661]:{'value':_0x222e9f?.[_0x372990(0x2fc)]?.[_0x222e9f[_0x372990(0x20e)]]?.[_0x41c661]||0x0}}))}}};await UtilDocuments[_0x372990(0x234)](this['_actor'],_0x569973);}if(this['_isLevelUp']){const {con:_0x7b9897}=Charactermancer_Util[_0x372990(0x2a2)](this[_0x372990(0x2e0)]);this[_0x372990(0x301)]=_0x7b9897;}_0x1f53c2[_0x372990(0x233)]({'message':_0x372990(0x2c1),'count':_0x3ab70f['_']});if(_0x1f53c2[_0x372990(0x2b0)])return _0x1f53c2['setProgress']({'message':'Build\x20cancelled.','count':_0x3ab70f['_']});}async['_pHandleSaveClick_race'](_0x5276b4){const _0x2718a7=_0x126d67,{progressWidget:_0x210b54,ptrTaskProgress:_0x2ed400}=_0x5276b4;_0x210b54[_0x2718a7(0x233)]({'message':'Importing\x20race...','count':++_0x2ed400['_']});const _0x473978=this['_compRace'][_0x2718a7(0x1d9)]();if(_0x473978){const _0x2ec4e6=new ImportListRace({'actor':this['_actor']});await _0x2ec4e6['pInit']();const _0x576e85=MiscUtil[_0x2718a7(0x26c)](_0x473978);delete _0x576e85['ability'],delete _0x576e85[_0x2718a7(0x29a)],delete _0x576e85[_0x2718a7(0x2ad)],delete _0x576e85['additionalSpells'];if(this[_0x2718a7(0x2d0)][_0x2718a7(0x2d8)])_0x576e85[_0x2718a7(0x2df)]=[(await this['_compRace']['compRaceSize'][_0x2718a7(0x20d)]())[_0x2718a7(0x2ec)]];else delete _0x576e85[_0x2718a7(0x2df)];await this['_pHandleSaveClick_pDoApplySkills']([this[_0x2718a7(0x2d0)][_0x2718a7(0x2b2)],this[_0x2718a7(0x2d0)]['compRaceSkillToolLanguageProficiencies']],_0x576e85,'skillProficiencies'),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this['_compRace'][_0x2718a7(0x1df)],this[_0x2718a7(0x2d0)][_0x2718a7(0x2a0)]],'toObj':_0x576e85,'path':[_0x2718a7(0x294)]}),await this[_0x2718a7(0x22c)]({'comps':[this['_compRace']['compRaceToolProficiencies'],this[_0x2718a7(0x2d0)][_0x2718a7(0x2a0)]],'toObj':_0x576e85,'path':[_0x2718a7(0x2da)]}),await this[_0x2718a7(0x22c)]({'comps':[this[_0x2718a7(0x2d0)]['compRaceExpertise']],'toObj':_0x576e85,'path':[_0x2718a7(0x2dc)]}),await this[_0x2718a7(0x22c)]({'comps':[this[_0x2718a7(0x2d0)][_0x2718a7(0x1dc)]],'toObj':_0x576e85,'path':[_0x2718a7(0x280)]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x2718a7(0x2d0)][_0x2718a7(0x274)]],'toObj':_0x576e85,'path':[_0x2718a7(0x25d)]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x2718a7(0x2d0)][_0x2718a7(0x1ca)]],'toObj':_0x576e85,'path':[_0x2718a7(0x1ee)],'isLegacy':!![]}),await this[_0x2718a7(0x22c)]({'comps':[this[_0x2718a7(0x2d0)]['compRaceDamageResistance']],'toObj':_0x576e85,'path':[_0x2718a7(0x1cb)],'isLegacy':!![]}),await this[_0x2718a7(0x22c)]({'comps':[this[_0x2718a7(0x2d0)][_0x2718a7(0x28e)]],'toObj':_0x576e85,'path':['vulnerable'],'isLegacy':!![]}),await this[_0x2718a7(0x22c)]({'comps':[this['_compRace']['compRaceConditionImmunity']],'toObj':_0x576e85,'path':[_0x2718a7(0x2c8)],'isLegacy':!![]}),await _0x2ec4e6[_0x2718a7(0x2b1)](_0x576e85,{'isCharactermancer':!![]});}_0x210b54[_0x2718a7(0x233)]({'message':_0x2718a7(0x26e),'count':_0x2ed400['_']});if(_0x210b54[_0x2718a7(0x2b0)])return _0x210b54[_0x2718a7(0x233)]({'message':_0x2718a7(0x230),'count':_0x2ed400['_']});}async[_0x126d67(0x1da)](_0x1decdd){const _0x85f888=_0x126d67,{progressWidget:_0x5121de,ptrTaskProgress:_0x38a199}=_0x1decdd;_0x5121de[_0x85f888(0x233)]({'message':_0x85f888(0x30d),'count':++_0x38a199['_']});const _0x5d728c=[];for(let _0x31ce30=0x0;_0x31ce30<this[_0x85f888(0x297)][_0x85f888(0x2f6)][_0x85f888(0x29f)]+0x1;++_0x31ce30){const {propIxClass:_0x14537c,propIxSubclass:_0x539520}=ActorCharactermancerBaseComponent['class_getProps'](_0x31ce30),_0xec4f8=this[_0x85f888(0x297)][_0x85f888(0x2e4)]({'propIxClass':_0x14537c});if(!_0xec4f8)continue;const _0x968b44=this[_0x85f888(0x297)][_0x85f888(0x2e8)]({'cls':_0xec4f8,'propIxSubclass':_0x539520});_0x5d728c[_0x85f888(0x213)]({'ix':_0x31ce30,'cls':_0xec4f8,'sc':_0x968b44,'isPrimary':this[_0x85f888(0x297)][_0x85f888(0x2f6)][_0x85f888(0x249)]===_0x31ce30});}if(_0x5d728c[_0x85f888(0x22b)]){_0x5d728c['sort']((_0x50fca7,_0x11c6bc)=>SortUtil[_0x85f888(0x28f)](Number(_0x11c6bc[_0x85f888(0x247)]),Number(_0x50fca7[_0x85f888(0x247)]))||SortUtil[_0x85f888(0x28f)](_0x50fca7[_0x85f888(0x2f0)]['name'],_0x11c6bc[_0x85f888(0x2f0)]['name']));const _0x5a3436=new ImportListClass({'actor':this[_0x85f888(0x2e0)]});await _0x5a3436[_0x85f888(0x2af)]();const _0x15ad01=this[_0x85f888(0x297)][_0x85f888(0x2e9)][_0x85f888(0x229)][_0x85f888(0x1f3)]['getValues']();for(let _0x48ad5f=0x0;_0x48ad5f<_0x5d728c[_0x85f888(0x22b)];++_0x48ad5f){const {ix:_0x5da3f8,cls:_0x37d77f,sc:_0x23b56e,isPrimary:_0x4f79a9}=_0x5d728c[_0x48ad5f],_0x1aebb1=MiscUtil[_0x85f888(0x26c)](_0x37d77f),_0x57d75b=_0x23b56e?MiscUtil[_0x85f888(0x26c)](_0x23b56e):null;if(_0x57d75b)delete _0x57d75b[_0x85f888(0x23c)];if(_0x57d75b)_0x1aebb1[_0x85f888(0x1d2)]=[_0x57d75b];else _0x1aebb1['subclasses']=[];_0x1aebb1['_foundrySelectedLevelIndices']=await this[_0x85f888(0x297)][_0x85f888(0x29b)][_0x5da3f8][_0x85f888(0x20d)]()[_0x85f888(0x2ec)];if(!_0x1aebb1['_foundrySelectedLevelIndices'][_0x85f888(0x22b)])continue;const _0x53e9bb=Math[_0x85f888(0x286)](..._0x1aebb1['_foundrySelectedLevelIndices'])+0x1;_0x1aebb1['_foundryStartingProficiencyMode']=_0x4f79a9?Charactermancer_Class_ProficiencyImportModeSelect[_0x85f888(0x1fb)]:Charactermancer_Class_ProficiencyImportModeSelect[_0x85f888(0x1f8)];if(this['_compClass'][_0x85f888(0x242)][_0x5da3f8]){const {mode:_0x413d73,customFormula:_0x456536}=(await this[_0x85f888(0x297)][_0x85f888(0x242)][_0x5da3f8][_0x85f888(0x20d)]())[_0x85f888(0x2ec)];_0x1aebb1['_foundryHpIncreaseMode']=_0x413d73,_0x1aebb1[_0x85f888(0x1e2)]=_0x456536;}_0x1aebb1[_0x85f888(0x24e)]=[];for(const _0x3fd966 of this[_0x85f888(0x297)][_0x85f888(0x2e6)][_0x5da3f8]){const _0x38975d=await _0x3fd966[_0x85f888(0x20d)](),_0x41cbb0={'system':{}};await Charactermancer_FeatureOptionsSelect['pDoApplyResourcesFormDataToActor']({'actor':this['_actor'],'formData':_0x38975d}),await Charactermancer_FeatureOptionsSelect[_0x85f888(0x251)]({'actor':this[_0x85f888(0x2e0)],'actorUpdate':_0x41cbb0,'formData':_0x38975d,'configGroup':'importClassSubclassFeature'});if(_0x38975d?.['data']?.[_0x85f888(0x266)]?.[_0x85f888(0x22b)])_0x1aebb1[_0x85f888(0x24e)][_0x85f888(0x213)](..._0x38975d[_0x85f888(0x2ec)][_0x85f888(0x266)]);await Charactermancer_FeatureOptionsSelect['pDoApplyProficiencyFormDataToActorUpdate'](this[_0x85f888(0x2e0)],_0x41cbb0,_0x38975d);if(Object[_0x85f888(0x208)](_0x41cbb0[_0x85f888(0x1d8)])[_0x85f888(0x22b)]||Object['keys'](_0x41cbb0['prototypeToken']||{})[_0x85f888(0x22b)])await UtilDocuments[_0x85f888(0x234)](this[_0x85f888(0x2e0)],_0x41cbb0);}_0x1aebb1['_foundryAllFeatures']['forEach'](_0x30540c=>delete _0x30540c?.['entity']?.[_0x85f888(0x23c)]);this[_0x85f888(0x217)]&&(_0x1aebb1[_0x85f888(0x288)]=this[_0x85f888(0x2c2)],_0x1aebb1['_foundryConFinal']=this[_0x85f888(0x301)]);_0x1aebb1[_0x85f888(0x2bf)]=!![],_0x1aebb1[_0x85f888(0x26a)]=!![];const _0x1fe1b4=_0x4f79a9?['startingProficiencies',_0x85f888(0x23e)]:[_0x85f888(0x1ec),_0x85f888(0x221),_0x85f888(0x23e)];await this['_pHandleSaveClick_pDoApplySkills']([this[_0x85f888(0x297)][_0x85f888(0x218)][_0x5da3f8]],_0x1aebb1,..._0x1fe1b4),delete _0x1aebb1[_0x85f888(0x300)];const _0x145a6a=this[_0x85f888(0x264)][_0x85f888(0x24a)][_0x5da3f8];await _0x5a3436['pImportClass'](_0x1aebb1,{'filterValues':_0x15ad01,'isCharactermancer':!![],'spellSlotLevelSelection':_0x145a6a?.[_0x85f888(0x279)]()?_0x145a6a[_0x85f888(0x268)]():null});for(const _0x4e0560 of this[_0x85f888(0x297)]['compsClassFeatureOptionsSelect'][_0x5da3f8]){const _0x5b7788=await _0x4e0560[_0x85f888(0x20d)]();await Charactermancer_FeatureOptionsSelect['pDoApplyAdditionalSpellsFormDataToActor']({'actor':this[_0x85f888(0x2e0)],'formData':_0x5b7788,'abilityAbv':_0x23b56e?.['spellcastingAbility']||_0x37d77f[_0x85f888(0x284)]});}}}_0x5121de[_0x85f888(0x233)]({'message':_0x85f888(0x272),'count':_0x38a199['_']});if(_0x5121de[_0x85f888(0x2b0)])return _0x5121de[_0x85f888(0x233)]({'message':_0x85f888(0x230),'count':_0x38a199['_']});}async[_0x126d67(0x25a)](_0x3852b1){const _0x1a141a=_0x126d67,{progressWidget:_0x3acd31,ptrTaskProgress:_0xa069b2}=_0x3852b1;_0x3acd31[_0x1a141a(0x233)]({'message':_0x1a141a(0x224),'count':++_0xa069b2['_']});const _0x1228da=this[_0x1a141a(0x236)]['getFeatureCustomizedBackground_']({'isAllowStub':![]});if(_0x1228da){const _0x914939=await this['_compBackground'][_0x1a141a(0x2b4)][_0x1a141a(0x20d)](),_0x59d735=_0x914939?.[_0x1a141a(0x2ec)]?.[_0x1a141a(0x20c)]??MiscUtil[_0x1a141a(0x26c)](_0x1228da),_0x238388=new ImportListBackground({'actor':this[_0x1a141a(0x2e0)]});await _0x238388[_0x1a141a(0x2af)]();if(this[_0x1a141a(0x236)][_0x1a141a(0x2b4)])_0x59d735[_0x1a141a(0x2c3)]=_0x914939;else _0x59d735[_0x1a141a(0x2c3)]={'isFormComplete':!![]};_0x59d735[_0x1a141a(0x2d7)]=!![],_0x59d735[_0x1a141a(0x246)]=!![],await this[_0x1a141a(0x2e3)]([this['_compBackground'][_0x1a141a(0x2bc)]],_0x59d735,_0x1a141a(0x209)),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x258)]?this[_0x1a141a(0x236)]['compBackgroundLanguageToolProficiencies']:this[_0x1a141a(0x236)][_0x1a141a(0x306)]],'toObj':_0x59d735,'path':[_0x1a141a(0x294)]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this['_compBackground'][_0x1a141a(0x258)]?this['_compBackground'][_0x1a141a(0x22d)]:this['_compBackground'][_0x1a141a(0x30a)]],'toObj':_0x59d735,'path':[_0x1a141a(0x2da)]}),await this[_0x1a141a(0x22c)]({'comps':[this['_compBackground'][_0x1a141a(0x23a)]],'toObj':_0x59d735,'path':[_0x1a141a(0x2dc)]}),await this[_0x1a141a(0x22c)]({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x1c7)]],'toObj':_0x59d735,'path':[_0x1a141a(0x280)]}),await this[_0x1a141a(0x22c)]({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x269)]],'toObj':_0x59d735,'path':[_0x1a141a(0x25d)]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x231)]],'toObj':_0x59d735,'path':[_0x1a141a(0x1ee)],'isLegacy':!![]}),await this[_0x1a141a(0x22c)]({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x1ea)]],'toObj':_0x59d735,'path':[_0x1a141a(0x1cb)],'isLegacy':!![]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x1a141a(0x236)][_0x1a141a(0x2c4)]],'toObj':_0x59d735,'path':[_0x1a141a(0x30e)],'isLegacy':!![]}),await this['_pHandleSaveClick_pDoApplyTraitLike']({'comps':[this[_0x1a141a(0x236)]['compBackgroundConditionImmunity']],'toObj':_0x59d735,'path':[_0x1a141a(0x2c8)],'isLegacy':!![]}),this[_0x1a141a(0x236)][_0x1a141a(0x200)]?_0x59d735[_0x1a141a(0x21a)]=await this['_compBackground'][_0x1a141a(0x200)][_0x1a141a(0x20d)]():_0x59d735[_0x1a141a(0x2ef)]=!![],delete _0x59d735[_0x1a141a(0x300)],delete _0x59d735[_0x1a141a(0x23c)],delete _0x59d735[_0x1a141a(0x29a)],await _0x238388['pImportEntry'](_0x59d735,{'isCharactermancer':!![]});}_0x3acd31[_0x1a141a(0x233)]({'message':'Imported\x20background.','count':_0xa069b2['_']});if(_0x3acd31[_0x1a141a(0x2b0)])return _0x3acd31['setProgress']({'message':'Build\x20cancelled.','count':_0xa069b2['_']});}async['_pHandleSaveClick_feats'](_0x1c1630){const _0x24e7f8=_0x126d67,{progressWidget:_0x2a3a61,ptrTaskProgress:_0x376f22}=_0x1c1630;_0x2a3a61['setProgress']({'message':_0x24e7f8(0x2f4),'count':++_0x376f22['_']});const _0x35db0f=await this[_0x24e7f8(0x2d2)][_0x24e7f8(0x2cc)]();if(_0x35db0f?.[_0x24e7f8(0x23b)]){const _0x59e9d8=this[_0x24e7f8(0x1f5)][_0x24e7f8(0x1f7)]['getFormDataAsi'](),_0x3b7e02=new ImportListFeat({'actor':this[_0x24e7f8(0x2e0)]});await _0x3b7e02['pInit']();for(const _0x5d445f of[_0x24e7f8(0x257),_0x24e7f8(0x214),'background','custom']){if(!_0x35db0f?.[_0x5d445f])continue;for(const {feat:_0x3a80e6,formDatasFeatureOptionsSelect:_0x370a91,ix:_0x3c9dfa}of _0x35db0f[_0x5d445f][_0x24e7f8(0x2ec)]){if(!_0x3a80e6)continue;if(_0x59e9d8[_0x24e7f8(0x29a)][_0x5d445f]?.[_0x3c9dfa]){const _0x1c2ca0=_0x59e9d8[_0x24e7f8(0x29a)][_0x5d445f]?.[_0x3c9dfa];_0x3a80e6[_0x24e7f8(0x257)]=[_0x1c2ca0[_0x24e7f8(0x304)]]['filter'](Boolean);if(!_0x3a80e6['ability'][_0x24e7f8(0x22b)])delete _0x3a80e6[_0x24e7f8(0x257)];_0x3a80e6[_0x24e7f8(0x1ce)]=_0x3a80e6?.[_0x24e7f8(0x257)]?.[0x0]||{},delete _0x3a80e6[_0x24e7f8(0x2e1)],Renderer['feat'][_0x24e7f8(0x302)](_0x3a80e6);}for(const _0x11e634 of _0x370a91){const _0x347b95={'system':{}};await Charactermancer_FeatureOptionsSelect[_0x24e7f8(0x24d)]({'actor':this['_actor'],'formData':_0x11e634}),await Charactermancer_FeatureOptionsSelect[_0x24e7f8(0x251)]({'actor':this[_0x24e7f8(0x2e0)],'actorUpdate':_0x347b95,'formData':_0x11e634,'configGroup':'importFeat'}),await Charactermancer_FeatureOptionsSelect[_0x24e7f8(0x289)](this[_0x24e7f8(0x2e0)],_0x347b95,_0x11e634);if(Object[_0x24e7f8(0x208)](_0x347b95[_0x24e7f8(0x1d8)])[_0x24e7f8(0x22b)])await this[_0x24e7f8(0x2e0)][_0x24e7f8(0x26d)](_0x347b95);let _0x1c10b6=null;if(_0x59e9d8[_0x24e7f8(0x29a)][_0x5d445f]?.[_0x3c9dfa]){const _0x2439f0=_0x59e9d8[_0x24e7f8(0x29a)][_0x5d445f]?.[_0x3c9dfa];_0x1c10b6=Object[_0x24e7f8(0x208)](_0x2439f0[_0x24e7f8(0x304)]||{})[0x0];}await Charactermancer_FeatureOptionsSelect[_0x24e7f8(0x1fe)]({'actor':this['_actor'],'formData':_0x11e634,'parentAbilityAbv':_0x1c10b6});if(_0x11e634?.['data']?.['features']?.[_0x24e7f8(0x22b)])for(let _0x247e68=0x0;_0x247e68<_0x11e634[_0x24e7f8(0x2ec)]['features'][_0x24e7f8(0x22b)];++_0x247e68){const _0x5842ec=_0x11e634[_0x24e7f8(0x2ec)][_0x24e7f8(0x266)][_0x247e68],_0x5aaac0=_0x5842ec[_0x24e7f8(0x1fa)]===_0x24e7f8(0x1f4)&&_0x247e68===0x0?MiscUtil[_0x24e7f8(0x26c)](_0x3a80e6):MiscUtil[_0x24e7f8(0x26c)](_0x5842ec[_0x24e7f8(0x2a6)]);delete _0x5aaac0[_0x24e7f8(0x257)],delete _0x5aaac0['skillProficiencies'],delete _0x5aaac0[_0x24e7f8(0x294)],delete _0x5aaac0[_0x24e7f8(0x2da)],delete _0x5aaac0['weaponProficiencies'],delete _0x5aaac0['armorProficiencies'],delete _0x5aaac0[_0x24e7f8(0x295)],delete _0x5aaac0[_0x24e7f8(0x216)],delete _0x5aaac0[_0x24e7f8(0x30f)],delete _0x5aaac0['damageVulnerabilities'],delete _0x5aaac0[_0x24e7f8(0x308)],delete _0x5aaac0[_0x24e7f8(0x2dc)],delete _0x5aaac0['resources'],delete _0x5aaac0[_0x24e7f8(0x25b)],delete _0x5aaac0[_0x24e7f8(0x23c)],await _0x3b7e02[_0x24e7f8(0x2b1)](_0x5aaac0,{'isCharactermancer':!![],'isLeaf':!![]});}}}}}_0x2a3a61[_0x24e7f8(0x233)]({'message':_0x24e7f8(0x2fe),'count':_0x376f22['_']});if(_0x2a3a61[_0x24e7f8(0x2b0)])return _0x2a3a61[_0x24e7f8(0x233)]({'message':_0x24e7f8(0x230),'count':_0x376f22['_']});}async[_0x126d67(0x1c2)](_0xf1d825){const _0x3a2ebc=_0x126d67,{progressWidget:_0x4eda5e,ptrTaskProgress:_0x21073f}=_0xf1d825;_0x4eda5e[_0x3a2ebc(0x233)]({'message':'Importing\x20spells...','count':++_0x21073f['_']});const _0x16aa08=this[_0x3a2ebc(0x264)][_0x3a2ebc(0x263)]||this[_0x3a2ebc(0x264)][_0x3a2ebc(0x1ff)][_0x3a2ebc(0x2b8)]();for(let _0x4fdc91=0x0;_0x4fdc91<this[_0x3a2ebc(0x297)][_0x3a2ebc(0x2f6)][_0x3a2ebc(0x29f)]+0x1;++_0x4fdc91){const {propIxClass:_0x45f4c9,propIxSubclass:_0xeb32b8}=ActorCharactermancerBaseComponent['class_getProps'](_0x4fdc91),_0x4be48a=this['_compClass']['getClass_']({'propIxClass':_0x45f4c9});if(!_0x4be48a)continue;const _0x4c6164=this[_0x3a2ebc(0x297)][_0x3a2ebc(0x2e8)]({'cls':_0x4be48a,'propIxSubclass':_0xeb32b8});if(this[_0x3a2ebc(0x264)][_0x3a2ebc(0x22f)][_0x4fdc91]){const _0x509550=await this[_0x3a2ebc(0x264)]['compsSpellSpells'][_0x4fdc91][_0x3a2ebc(0x20d)](_0x16aa08);await Charactermancer_Spell['pApplyFormDataToActor'](this[_0x3a2ebc(0x2e0)],_0x509550,{'cls':_0x4be48a,'sc':_0x4c6164});}if(this[_0x3a2ebc(0x264)]['compsSpellAdditionalSpellClass'][_0x4fdc91]){const _0x463714=await this[_0x3a2ebc(0x264)][_0x3a2ebc(0x28a)][_0x4fdc91]['pGetFormData']();await this[_0x3a2ebc(0x21f)]({'formData':_0x463714,'abilityAbv':_0x4be48a[_0x3a2ebc(0x284)]});}if(!_0x4c6164)continue;if(this[_0x3a2ebc(0x264)]['compsSpellAdditionalSpellSubclass'][_0x4fdc91]){const _0x9c3dc6=await this[_0x3a2ebc(0x264)][_0x3a2ebc(0x1d4)][_0x4fdc91][_0x3a2ebc(0x20d)]();await this[_0x3a2ebc(0x21f)]({'formData':_0x9c3dc6,'abilityAbv':_0x4c6164?.[_0x3a2ebc(0x284)]||_0x4be48a[_0x3a2ebc(0x284)]});}}const _0x2820b6=[this[_0x3a2ebc(0x264)][_0x3a2ebc(0x303)],this[_0x3a2ebc(0x264)]['compSpellAdditionalSpellBackground']];for(const _0x2baaaf of _0x2820b6){if(!_0x2baaaf)continue;const _0x58a438=await _0x2baaaf['pGetFormData']();await this[_0x3a2ebc(0x21f)]({'formData':_0x58a438});}_0x4eda5e[_0x3a2ebc(0x233)]({'message':_0x3a2ebc(0x29c),'count':_0x21073f['_']});if(_0x4eda5e['isCancelled'])return _0x4eda5e[_0x3a2ebc(0x233)]({'message':_0x3a2ebc(0x230),'count':_0x21073f['_']});}async[_0x126d67(0x20b)](_0x110b81){const _0xf12aeb=_0x126d67,{progressWidget:_0x4431db,ptrTaskProgress:_0x3f560f}=_0x110b81;_0x4431db[_0xf12aeb(0x233)]({'message':'Importing\x20equipment...','count':++_0x3f560f['_']});const _0x41c95b=await this[_0xf12aeb(0x29d)]['compEquipmentCurrency'][_0xf12aeb(0x20d)](),_0x175ea0=await this['_compEquipment']['compEquipmentStartingDefault']['pGetFormData'](),_0x2fc1a1=await this[_0xf12aeb(0x29d)][_0xf12aeb(0x2a9)][_0xf12aeb(0x20d)]();if(_0x41c95b?.[_0xf12aeb(0x2ec)]?.[_0xf12aeb(0x27d)])await Charactermancer_StartingEquipment[_0xf12aeb(0x2f1)](this['_actor'],_0x41c95b);if(_0x175ea0?.[_0xf12aeb(0x2ec)]?.[_0xf12aeb(0x259)])await Charactermancer_StartingEquipment[_0xf12aeb(0x1cc)](this[_0xf12aeb(0x2e0)],_0x175ea0);if(_0x2fc1a1?.[_0xf12aeb(0x2ec)]?.[_0xf12aeb(0x259)])await Charactermancer_StartingEquipment['pImportEquipmentItemEntries'](this[_0xf12aeb(0x2e0)],_0x2fc1a1);_0x4431db[_0xf12aeb(0x233)]({'message':_0xf12aeb(0x226),'count':_0x3f560f['_']});if(_0x4431db[_0xf12aeb(0x2b0)])return _0x4431db[_0xf12aeb(0x233)]({'message':'Build\x20cancelled.','count':_0x3f560f['_']});}async[_0x126d67(0x2e3)](_0x76ba10,_0x1306bd,..._0xfd07b2){const _0x1d1b75=_0x126d67;MiscUtil[_0x1d1b75(0x1c5)](_0x1306bd,..._0xfd07b2),_0x76ba10=(_0x76ba10||[])[_0x1d1b75(0x2cf)](Boolean);if(!_0x76ba10[_0x1d1b75(0x22b)])return;const _0x20ea65={};for(const _0x2a4bb4 of _0x76ba10){const _0x253ed2=await _0x2a4bb4[_0x1d1b75(0x20d)]();Object[_0x1d1b75(0x208)](Parser[_0x1d1b75(0x2cb)])[_0x1d1b75(0x2cf)](_0x972e9=>_0x253ed2[_0x1d1b75(0x2ec)]?.[_0x1d1b75(0x209)]?.[_0x972e9])[_0x1d1b75(0x1c4)](_0x14d2d7=>_0x20ea65[_0x14d2d7]=!![]);}Object[_0x1d1b75(0x208)](_0x20ea65)[_0x1d1b75(0x22b)]&&MiscUtil['set'](_0x1306bd,..._0xfd07b2,[_0x20ea65]);}async[_0x126d67(0x22c)]({comps:_0x263c33,toObj:_0x4d7d2f,path:_0xf82d6c,isLegacy:isLegacy=![]}){const _0x2cfd46=_0x126d67,_0x31fde5=_0xf82d6c[_0x2cfd46(0x298)]();MiscUtil[_0x2cfd46(0x1c5)](_0x4d7d2f,..._0xf82d6c),_0x263c33=_0x263c33['filter'](Boolean);if(!_0x263c33[_0x2cfd46(0x22b)])return;const _0x174489=(await _0x263c33[_0x2cfd46(0x30c)](_0x1cbce4=>_0x1cbce4[_0x2cfd46(0x20d)]()))[_0x2cfd46(0x2cd)](_0x1cdbfd=>_0x1cdbfd?.[_0x2cfd46(0x2ec)]?.[_0x31fde5])[_0x2cfd46(0x2cf)](Boolean);if(isLegacy){const _0x599d1e=_0x174489[_0x2cfd46(0x2cd)](_0x1774a4=>Object[_0x2cfd46(0x208)](_0x1774a4));if(_0x599d1e[_0x2cfd46(0x22b)])MiscUtil[_0x2cfd46(0x206)](_0x4d7d2f,..._0xf82d6c,_0x599d1e);}else{const _0x165a7e=_0x174489['mergeMap'](_0x27570e=>_0x27570e);if(Object['keys'](_0x165a7e)[_0x2cfd46(0x22b)])MiscUtil[_0x2cfd46(0x206)](_0x4d7d2f,..._0xf82d6c,[_0x165a7e]);}}async[_0x126d67(0x21f)]({formData:_0xc46656,abilityAbv:_0x10533a,parentAbilityAbv:_0x1dd293}){const _0x528f5a=_0x126d67;await Charactermancer_AdditionalSpellsSelect[_0x528f5a(0x273)](this['_actor'],_0xc46656,{'abilityAbv':_0x10533a,'parentAbilityAbv':_0x1dd293});}async[_0x126d67(0x1e4)](_0x14c10e){const _0x2125f0=_0x126d67,{progressWidget:_0x24b7bc,ptrTaskProgress:_0x17e058}=_0x14c10e;_0x24b7bc[_0x2125f0(0x233)]({'message':_0x2125f0(0x220),'count':++_0x17e058['_']});if(this['_cbPostSave'])this[_0x2125f0(0x211)]();}},ActorCharactermancer[_0x126d67(0x2de)][_0x126d67(0x1f1)]=class{constructor({progressWidget:_0x5b56bd,ptrTaskProgress:_0xa15505}){const _0x3fee4a=_0x126d67;this[_0x3fee4a(0x239)]=_0x5b56bd,this[_0x3fee4a(0x232)]=_0xa15505;}};export{ActorCharactermancerSourceSelector,ActorCharactermancerBaseComponent};